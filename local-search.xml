<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>XYCTF-Crypto方向部分wp</title>
    <link href="/2024/04/28/XYCTF/"/>
    <url>/2024/04/28/XYCTF/</url>
    
    <content type="html"><![CDATA[<p>时长一个月终于结束了，最后只做了一半多一道，还是太菜了，感觉自己如学</p><h3 id="x0r"><a href="#x0r" class="headerlink" title="x0r"></a>x0r</h3><h4 id="解答："><a href="#解答：" class="headerlink" title="解答："></a>解答：</h4><p>nc连接，输入1得iv和enc，输入2后分别将得到的iv和enc输入即可得到flag</p><h3 id="factor1"><a href="#factor1" class="headerlink" title="factor1"></a>factor1</h3><h4 id="题目："><a href="#题目：" class="headerlink" title="题目："></a>题目：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>d = getPrime(<span class="hljs-number">512</span>)<br>e = gmpy2.invert(d, (p**<span class="hljs-number">3</span> - <span class="hljs-number">1</span>) * (q**<span class="hljs-number">3</span> - <span class="hljs-number">1</span>))<br>flag = <span class="hljs-string">&quot;XYCTF&#123;&quot;</span> + hashlib.md5(<span class="hljs-built_in">str</span>(p + q).encode()).hexdigest() + <span class="hljs-string">&quot;&#125;&quot;</span><br><span class="hljs-built_in">print</span>(e)<br><span class="hljs-built_in">print</span>(p * q)<br></code></pre></td></tr></table></figure><h4 id="解答：-1"><a href="#解答：-1" class="headerlink" title="解答："></a>解答：</h4><script type="math/tex; mode=display">\begin{align}de&\equiv1\pmod{(p^{3}-1)(q^{3}-1)}\\de&=1+k(p^{3}-1)(q^{3}-1)\\\frac{e}{(p^{3}-1)(q^{3}-1)}&=\frac{1}{d(p^{3}-1)(q^{3}-1)}+\frac{k}{d}\approx\frac{k}{d}\\\because(p^{3}-1)(q^{3}-1)&\approx p^{3}q^{3}\\\therefore \frac{e}{p^{3}q^{3}}&\approx\frac{k}{d}\end{align}</script><p>因此通过连分数展开的思想得到k、d<br>令$x=p+q$, $temp=\frac{ed-1}{k}$</p><script type="math/tex; mode=display">\begin{align}temp=(p^{3}-1)(q^{3}-1)&=p^{3}q^{3}-p^{3}-q^{3}+1\\p^{3}+q^{3}&=p^{3}q^{3}-temp-1\\x^3-3pqx&=p^{3}q^{3}-temp-1\\f=x^3-3pqx&-(p^{3}q^{3}-temp-1)\end{align}</script><p>求解多项式即可得到x</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># sage:</span><br>e = ...<br>pq = ...<br>pqx = pq ^ <span class="hljs-number">3</span><br>fra = (e/pqx).continued_fraction()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(fra)):<br>    k, d = fra.numerator(i), fra.denominator(i)<br>    <span class="hljs-keyword">if</span> (e*d - <span class="hljs-number">1</span>) % k == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> d &gt; <span class="hljs-number">2</span>^<span class="hljs-number">250</span>:<br>        <span class="hljs-keyword">break</span><br><br>temp = (e*d - <span class="hljs-number">1</span>) // k<br>pq3 = pqx - temp + <span class="hljs-number">1</span><br>x = PolynomialRing(RationalField(), <span class="hljs-string">&#x27;x&#x27;</span>).gen()<br>f = x^<span class="hljs-number">3</span>-<span class="hljs-number">3</span>*pq*x-pq3<br>p_q = <span class="hljs-built_in">int</span>(f.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>])<br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> iroot<br><span class="hljs-keyword">import</span> hashlib<br><br>flag = <span class="hljs-string">&quot;XYCTF&#123;&quot;</span> + hashlib.md5(<span class="hljs-built_in">str</span>(p_q).encode()).hexdigest() + <span class="hljs-string">&quot;&#125;&quot;</span><br><span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">XYCTF&#123;a83211a70e18145a59671c08ddc67ba4&#125;</span><br></code></pre></td></tr></table></figure><h3 id="factor3"><a href="#factor3" class="headerlink" title="factor3"></a>factor3</h3><p><a href="https://blog.csdn.net/weixin_52640415/article/details/130625454">薅过来用</a></p><h4 id="题目：-1"><a href="#题目：-1" class="headerlink" title="题目："></a>题目：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><br>flag = <span class="hljs-string">b&#x27;XYCTF&#123;*****&#125;&#x27;</span><br>m = bytes_to_long(flag)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gainPrime</span>():<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        x = random.getrandbits(<span class="hljs-number">256</span>)<br>        y = random.getrandbits(<span class="hljs-number">256</span>)<br><br>        <span class="hljs-keyword">if</span> y % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">continue</span><br><br>        p = x ** <span class="hljs-number">3</span> + <span class="hljs-number">3</span> * y ** <span class="hljs-number">3</span><br>        <span class="hljs-keyword">if</span> p.bit_length() == <span class="hljs-number">768</span> <span class="hljs-keyword">and</span> p % <span class="hljs-number">2</span> == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> isPrime(p):<br>            <span class="hljs-keyword">return</span> p<br><br>p, q = gainPrime(), gainPrime()<br>N = p * q<br>phi = (p ** <span class="hljs-number">2</span> + p + <span class="hljs-number">1</span>) * (q ** <span class="hljs-number">2</span> + q + <span class="hljs-number">1</span>)<br>d = getPrime(<span class="hljs-number">320</span>)<br>e = inverse(d, phi)<br>c = d**<span class="hljs-number">2</span>^m<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;N: <span class="hljs-subst">&#123;N&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;e: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c: <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br><br></code></pre></td></tr></table></figure><h4 id="解答：-2"><a href="#解答：-2" class="headerlink" title="解答："></a>解答：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-comment">############################################</span><br><span class="hljs-comment"># Config</span><br><span class="hljs-comment">##########################################</span><br><br>debug = <span class="hljs-literal">True</span><br>strict = <span class="hljs-literal">False</span><br>helpful_only = <span class="hljs-literal">True</span><br>dimension_min = <span class="hljs-number">7</span> <span class="hljs-comment"># stop removing if lattice reaches that dimension</span><br><br><span class="hljs-comment">############################################</span><br><span class="hljs-comment"># Functions</span><br><span class="hljs-comment">##########################################</span><br><span class="hljs-comment"># display stats on helpful vectors</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">helpful_vectors</span>(<span class="hljs-params">BB, modulus</span>):<br>    nothelpful = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(BB.dimensions()[<span class="hljs-number">0</span>]):<br>        <span class="hljs-keyword">if</span> BB[ii,ii] &gt;= modulus:<br>            nothelpful += <span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span>(nothelpful, <span class="hljs-string">&quot;/&quot;</span>, BB.dimensions()[<span class="hljs-number">0</span>], <span class="hljs-string">&quot; vectors are not helpful&quot;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">matrix_overview</span>(<span class="hljs-params">BB, bound</span>):<br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(BB.dimensions()[<span class="hljs-number">0</span>]):<br>        a = (<span class="hljs-string">&#x27;%02d &#x27;</span> % ii)<br>        <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(BB.dimensions()[<span class="hljs-number">1</span>]):<br>            a += <span class="hljs-string">&#x27;0&#x27;</span> <span class="hljs-keyword">if</span> BB[ii,jj] == <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;X&#x27;</span><br>            <span class="hljs-keyword">if</span> BB.dimensions()[<span class="hljs-number">0</span>] &lt; <span class="hljs-number">60</span>:<br>                a += <span class="hljs-string">&#x27; &#x27;</span><br>        <span class="hljs-keyword">if</span> BB[ii, ii] &gt;= bound:<br>            a += <span class="hljs-string">&#x27;~&#x27;</span><br>        <span class="hljs-built_in">print</span>(a)<br><br>  <br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">remove_unhelpful</span>(<span class="hljs-params">BB, monomials, bound, current</span>):<br>    <span class="hljs-keyword">if</span> current == -<span class="hljs-number">1</span> <span class="hljs-keyword">or</span> BB.dimensions()[<span class="hljs-number">0</span>] &lt;= dimension_min:<br>        <span class="hljs-keyword">return</span> BB<br><br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(current, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">if</span> BB[ii, ii] &gt;= bound:<br>            affected_vectors = <span class="hljs-number">0</span><br>            affected_vector_index = <span class="hljs-number">0</span><br><br>            <span class="hljs-comment"># let&#x27;s check if it affects other vectors</span><br>            <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ii + <span class="hljs-number">1</span>, BB.dimensions()[<span class="hljs-number">0</span>]):<br>                <span class="hljs-keyword">if</span> BB[jj, ii] != <span class="hljs-number">0</span>:<br>                    affected_vectors += <span class="hljs-number">1</span><br>                    affected_vector_index = jj<br><br>            <span class="hljs-keyword">if</span> affected_vectors == <span class="hljs-number">0</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;* removing unhelpful vector&quot;</span>, ii)<br>                BB = BB.delete_columns([ii])<br>                BB = BB.delete_rows([ii])<br>                monomials.pop(ii)<br>                BB = remove_unhelpful(BB, monomials, bound, ii-<span class="hljs-number">1</span>)<br>                <span class="hljs-keyword">return</span> BB<br><br>            <span class="hljs-keyword">elif</span> affected_vectors == <span class="hljs-number">1</span>:<br>                affected_deeper = <span class="hljs-literal">True</span><br><br>                <span class="hljs-keyword">for</span> kk <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(affected_vector_index + <span class="hljs-number">1</span>, BB.dimensions()[<span class="hljs-number">0</span>]):<br>                <br>                    <span class="hljs-keyword">if</span> BB[kk, affected_vector_index] != <span class="hljs-number">0</span>:<br>                        affected_deeper = <span class="hljs-literal">False</span><br>  <br>                <span class="hljs-keyword">if</span> affected_deeper <span class="hljs-keyword">and</span> <span class="hljs-built_in">abs</span>(bound - BB[affected_vector_index, affected_vector_index]) &lt; <span class="hljs-built_in">abs</span>(bound - BB[ii, ii]):<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;* removing unhelpful vectors&quot;</span>, ii, <span class="hljs-string">&quot;and&quot;</span>, affected_vector_index)<br>                    BB = BB.delete_columns([affected_vector_index, ii])<br>                    BB = BB.delete_rows([affected_vector_index, ii])<br>                    monomials.pop(affected_vector_index)<br>                    monomials.pop(ii)<br>                    BB = remove_unhelpful(BB, monomials, bound, ii-<span class="hljs-number">1</span>)<br>                    <span class="hljs-keyword">return</span> BB<br>    <span class="hljs-keyword">return</span> BB<br>    <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">attack</span>(<span class="hljs-params">N, e, m, t, X, Y</span>):<br>    modulus = e<br>    PR.&lt;x, y&gt; = PolynomialRing(ZZ)<br>    a = N + <span class="hljs-number">1</span><br>    b = N * N - N + <span class="hljs-number">1</span><br>    f = x * (y * y + a * y + b) + <span class="hljs-number">1</span><br>    gg = []<br>    <br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, m+<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(k, m+<span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span> * k, <span class="hljs-number">2</span> * k + <span class="hljs-number">2</span>):<br>                gg.append(x^(i-k) * y^(j-<span class="hljs-number">2</span>*k) * f^k * e^(m - k))<br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, m+<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(k, k+<span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>*k+<span class="hljs-number">2</span>, <span class="hljs-number">2</span>*i+t+<span class="hljs-number">1</span>):<br>                gg.append(x^(i-k) * y^(j-<span class="hljs-number">2</span>*k) * f^k * e^(m - k))<br>                <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">order_gg</span>(<span class="hljs-params">idx, gg, monomials</span>):<br>        <span class="hljs-keyword">if</span> idx == <span class="hljs-built_in">len</span>(gg):<br>            <span class="hljs-keyword">return</span> gg, monomials<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(idx, <span class="hljs-built_in">len</span>(gg)):<br>            polynomial = gg[i]<br>            non = []<br>            <span class="hljs-keyword">for</span> monomial <span class="hljs-keyword">in</span> polynomial.monomials():<br>                <span class="hljs-keyword">if</span> monomial <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> monomials:<br>                    non.append(monomial)<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(non) == <span class="hljs-number">1</span>:<br>                new_gg = gg[:]<br>                new_gg[i], new_gg[idx] = new_gg[idx], new_gg[i]<br>                <span class="hljs-keyword">return</span> order_gg(idx + <span class="hljs-number">1</span>, new_gg, monomials + non)    <br>    gg, monomials = order_gg(<span class="hljs-number">0</span>, gg, [])<br>  <br>    nn = <span class="hljs-built_in">len</span>(monomials)<br>    BB = Matrix(ZZ, nn)<br>    <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nn):<br>        BB[ii, <span class="hljs-number">0</span>] = gg[ii](<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, nn):<br>            <span class="hljs-keyword">if</span> monomials[jj] <span class="hljs-keyword">in</span> gg[ii].monomials():<br>                BB[ii, jj] = gg[ii].monomial_coefficient(monomials[jj]) * monomials[jj](X, Y)<br><br>    <span class="hljs-keyword">if</span> helpful_only:<br>        <span class="hljs-comment"># automatically remove</span><br>        BB = remove_unhelpful(BB, monomials, modulus^m, nn-<span class="hljs-number">1</span>)<br>        <span class="hljs-comment"># reset dimension</span><br>        nn = BB.dimensions()[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">if</span> nn == <span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;failure&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>,<span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">if</span> debug:<br>        helpful_vectors(BB, modulus^m)<br>    <span class="hljs-comment"># check if determinant is correctly bounded</span><br>    det = BB.det()<br>    bound = modulus^(m*nn)<br>    <span class="hljs-keyword">if</span> det &gt;= bound:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;We do not have det &lt; bound. Solutions might not be found.&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Try with highers m and t.&quot;</span>)<br>        <span class="hljs-keyword">if</span> debug:<br>            diff = (log(det) - log(bound)) / log(<span class="hljs-number">2</span>)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;size det(L) - size e^(m*n) = &quot;</span>, floor(diff))<br>        <span class="hljs-keyword">if</span> strict:<br>            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)&quot;</span>)<br><br>    <span class="hljs-keyword">if</span> debug:<br>        matrix_overview(BB, modulus^m)<br>    <span class="hljs-keyword">if</span> debug:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;optimizing basis of the lattice via LLL, this can take a long time&quot;</span>)<br>    BB = BB.LLL()<br>    <span class="hljs-keyword">if</span> debug:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;LLL is done!&quot;</span>)<br>    <span class="hljs-keyword">if</span> debug:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;looking for independent vectors in the lattice&quot;</span>)<br>        <br>    found_polynomials = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">for</span> pol1_idx <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nn - <span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">for</span> pol2_idx <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(pol1_idx + <span class="hljs-number">1</span>, nn):<br>            PR.&lt;a, b&gt; = PolynomialRing(ZZ)<br>            pol1 = pol2 = <span class="hljs-number">0</span><br>            <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nn):<br>                pol1 += monomials[jj](a,b) * BB[pol1_idx, jj] / monomials[jj](X, Y)<br>                pol2 += monomials[jj](a,b) * BB[pol2_idx, jj] / monomials[jj](X, Y)<br>            PR.&lt;q&gt; = PolynomialRing(ZZ)<br>            rr = pol1.resultant(pol2)<br>  <br>            <span class="hljs-keyword">if</span> rr.is_zero() <span class="hljs-keyword">or</span> rr.monomials() == [<span class="hljs-number">1</span>]:<br>                <span class="hljs-keyword">continue</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;found them, using vectors&quot;</span>, pol1_idx, <span class="hljs-string">&quot;and&quot;</span>, pol2_idx)<br>                found_polynomials = <span class="hljs-literal">True</span><br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">if</span> found_polynomials:<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> found_polynomials:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;no independant vectors could be found. This should very rarely happen...&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span><br>    rr = rr(q, q)<br>    <span class="hljs-comment"># solutions</span><br>    soly = rr.roots()<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(soly) == <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Your prediction (delta) is too small&quot;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>, <span class="hljs-number">0</span><br>    soly = soly[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br>    ss = pol1(q, soly)<br>    solx = ss.roots()[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">return</span> solx, soly<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">inthroot</span>(<span class="hljs-params">a, n</span>):<br>    <span class="hljs-keyword">return</span> a.nth_root(n, truncate_mode=<span class="hljs-literal">True</span>)[<span class="hljs-number">0</span>]<br>N = <span class="hljs-number">913125842482770239379848062277162627509794409924607555622246822717218133091223291889541294440266178282194506242444509803611492259403578922020590849630191477864719052980160940803309686069818208833547621252544423652489179493083138385424424384165228024273745733240109761707533778691158938848158094054261174692601673435971526522219273943464877956131040249169850420336023942653021547841666224446678539579529590840999008107782784268926145671962239929431694391039559247</span><br><br>e = <span class="hljs-number">494518390582436635999115147756676313570637682518235195828939117782099618734167908630788943568232122157772909140885391963441876427590731524706959546524212914108888799081844320513851526790475333924396837458796755678072486028072639014677580265244176441153444956871730684233063789931539669072735599696830757690822185323538738397827461580678488181113667710378657058297572328491762536595872579603698945272140918157163640403488075948987156585480146162739943419183496337465468187233821931312507662218106713861638334075899266373256620752680354704533272722692596941861606161634082613228896420520465402725359166156632884432690715903666803067996854084671477445131853993177110154928274312496230096270510089973592664248613332000290545537840595645944390047611474888693558676781309912289044962293014118087259307560444929227407113819165713213046898243995956550944640168932947118400215917515277554126694376415569909534496134700668701465649939</span><br><br>X = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">469</span><br><br>Y = <span class="hljs-number">2</span> * inthroot(Integer(<span class="hljs-number">2</span> * N), <span class="hljs-number">2</span>)<br><br>res = attack(N, e, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, X, Y)<br><br><span class="hljs-built_in">print</span>(res)<br><br>b, c = res[<span class="hljs-number">1</span>], N<br><br>Dsqrt =  inthroot(Integer(b^<span class="hljs-number">2</span>-<span class="hljs-number">4</span>*c),<span class="hljs-number">2</span>)<br><br>p, q = (b + Dsqrt) // <span class="hljs-number">2</span>, (b - Dsqrt) // <span class="hljs-number">2</span><br><br><span class="hljs-keyword">assert</span> p * q == N<br><span class="hljs-built_in">print</span>(p)<br><span class="hljs-built_in">print</span>(q)<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>p = <span class="hljs-number">1079692686288325812308630934214667048073665141240195252583556389192093937087035206847129125872559936616225942097278411602071282941911673739879515157769270737229378250560113256396308250699296075273110248314981762673299506406938725953</span><br>q = <span class="hljs-number">845727542734252771097508620366884787581346823455578404917525769041539439746914530374958818236462967773717478357930648479282951655380705183747821800053493097745787392338644671787997907165214166274630065657567039034950440073852768399</span><br>c = <span class="hljs-number">4450931337369461482106945992542133557585962894030505065110870389112565329875502952762182372926117037373210509516570958483606566274369840551132381128665744266165792377925899683228751870742727716</span><br>N = p * q<br>phi = (p ** <span class="hljs-number">2</span> + p + <span class="hljs-number">1</span>) * (q ** <span class="hljs-number">2</span> + q + <span class="hljs-number">1</span>)<br>e = <span class="hljs-number">494518390582436635999115147756676313570637682518235195828939117782099618734167908630788943568232122157772909140885391963441876427590731524706959546524212914108888799081844320513851526790475333924396837458796755678072486028072639014677580265244176441153444956871730684233063789931539669072735599696830757690822185323538738397827461580678488181113667710378657058297572328491762536595872579603698945272140918157163640403488075948987156585480146162739943419183496337465468187233821931312507662218106713861638334075899266373256620752680354704533272722692596941861606161634082613228896420520465402725359166156632884432690715903666803067996854084671477445131853993177110154928274312496230096270510089973592664248613332000290545537840595645944390047611474888693558676781309912289044962293014118087259307560444929227407113819165713213046898243995956550944640168932947118400215917515277554126694376415569909534496134700668701465649939</span><br><br>d = gmpy2.invert(e, phi)<br>m = d**<span class="hljs-number">2</span>^c<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">b&#x27;XYCTF&#123;I_love_to_read_the_crypto_paper_and_try_to_ak_them&#125;&#x27;</span><br></code></pre></td></tr></table></figure><p>板子的论文：<a href="https://eprint.iacr.org/2021/1160.pdf">1160.pdf (iacr.org)</a></p><h3 id="happy-to-solve1"><a href="#happy-to-solve1" class="headerlink" title="happy_to_solve1"></a>happy_to_solve1</h3><h4 id="题目：-2"><a href="#题目：-2" class="headerlink" title="题目："></a>题目：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> sympy<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_happy_prime</span>():<br>    p = getPrime(<span class="hljs-number">512</span>)<br>    q = sympy.nextprime(p ^ ((<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">512</span>) - <span class="hljs-number">1</span>))<br>    <span class="hljs-keyword">return</span> p, q<br><br><br>m = bytes_to_long(flag)<br>p, q = get_happy_prime()<br>n = p * q<br>e = <span class="hljs-number">65537</span><br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(m, e, n))<br></code></pre></td></tr></table></figure><h4 id="解答：-3"><a href="#解答：-3" class="headerlink" title="解答："></a>解答：</h4><p>由异或性质得：如果a&gt;b，且a为二进制全为1,那么a^b=a-b<br>所以((1&lt;<512)-1)^p=(1<<1024)-p。设p^((1<<512)-1)的下一个素数与p^((1<<512)-1)相差r，则$q=(1<<512-1)-p+r$，$p+q=1<<512-1+r$，$p+q\approx 1<<512$，$n=pq=(\frac{p+q}{2})^{2}-(\frac{p-q}{2})^{2}$，将$p+q$带入得$p-q\approx\sqrt{(p+q)^{2}-4n}$，所以$p\approx\frac{(1<<1024)+\sqrt{(1<<1024)^{2}}-4n}{2}$，根据n%p=0向后爆破<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python">n = <span class="hljs-number">24852206647750545040640868093921252282805229864862413863025873203291042799096787789288461426555716785288286492530194901130042940279109598071958012303179823645151637759103558737126271435636657767272703908384802528366090871653024192321398785017073393201385586868836278447340624427705360349350604325533927890879</span><br>c = <span class="hljs-number">14767985399473111932544176852718061186100743117407141435994374261886396781040934632110608219482140465671269958180849886097491653105939368395716596413352563005027867546585191103214650790884720729601171517615620202183534021987618146862260558624458833387692782722514796407503120297235224234298891794056695442287</span><br><br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>e=<span class="hljs-number">65537</span><br>t1=<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">1024</span><br>p=(<span class="hljs-number">2</span>**<span class="hljs-number">512</span>+gmpy2.iroot((<span class="hljs-number">2</span>**<span class="hljs-number">1024</span>-<span class="hljs-number">4</span>*n,<span class="hljs-number">2</span>)[<span class="hljs-number">0</span>])//<span class="hljs-number">2</span><br>p=<span class="hljs-built_in">int</span>(p)<br><span class="hljs-keyword">while</span> n%p!=<span class="hljs-number">0</span>:<br>    p=gmpy2.next_prime(p)<br>q=n//p<br>phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d=gmpy2.invert(e,phi)<br>m=<span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">b&#x27;XYCTF&#123;3f22f4efe3bbbc71bbcc999a0a622a1a23303cdc&#125;&#x27;</span><br></code></pre></td></tr></table></figure></p><h3 id="happy-to-solve2"><a href="#happy-to-solve2" class="headerlink" title="happy_to_solve2"></a>happy_to_solve2</h3><h4 id="题目：-3"><a href="#题目：-3" class="headerlink" title="题目："></a>题目：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_happy_prime</span>():<br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        p = <span class="hljs-built_in">int</span>(<span class="hljs-string">&quot;&quot;</span>.join([random.choice(<span class="hljs-string">&quot;123&quot;</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">512</span>)]))<br>        q = <span class="hljs-built_in">int</span>(<span class="hljs-string">&quot;&quot;</span>.join([random.choice(<span class="hljs-string">&quot;567&quot;</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">512</span>)]))<br>        <span class="hljs-keyword">if</span> isPrime(p) <span class="hljs-keyword">and</span> isPrime(q):<br>            <span class="hljs-keyword">return</span> (p,q)<br><br>m = bytes_to_long(flag)<br>p ,q= get_happy_prime()<br>n = p * q<br>e = <span class="hljs-number">65537</span><br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(m, e, n))<br></code></pre></td></tr></table></figure><h4 id="解答：-4"><a href="#解答：-4" class="headerlink" title="解答："></a>解答：</h4><p>用$pq\equiv 10\mod{10^{i}}$  DFS 搜寻<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> product<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br>n = <span class="hljs-number">697906506747097082736076931509594586899561519277373830451275402914416296858960649459482027106166486723487162428522597262774248272216088755005277069446993003521270487750989061229071167729138628583207229945902389632065500739730301375338674342457656803764567184544685006193130563116558641331897204457729877920989968662546183628637193220770495938729301979912328865798266631957128761871326655572836258178871966196973138373358029531478246243442559418904559585334351259080578222274926069834941166567112522869638854253933559832822899069320370733424453856240903784235604251466010104012061821038897933884352804297256364409157501116832788696434711523621632436970698827611375698724661553712549209133526623456888111161142213830821361143023186927163314212097199831985368310770663850851571934739809387798422381702174820982531508641022827776262236373967579266271031713520262606203067411268482553539580686495739014567368858613520107678565628269250835478345171330669316220473129104495659093134763261751546990704365966783697780787341963138501</span><br>c = <span class="hljs-number">153383826085102296581238539677668696644156148059026868813759015106139131297135097831661048493079405226972222492151356105759235749502324303047037349410709021152255315429280760639113724345836532087970918453353723090554450581657930847674930226113840172368662838756446364482977092478979838209396761279326533419699056209983721842484996150025403009644653678928025861445324715419893797015875541525590135843027312322236085581571452084477262582966972702577136904385741443870527205640874446616413917231260133364227248928492574610248881137364204914001412269740461851747883355414968499272944590071623223603501698004227753335552646715567802825755799597955409228004284739743749531270833084850113574712041224896044525292591264637452797151098802604186311724597450780520140413704697374209653369969451501627583467893160412780732575085846467289134920886789952338174193202234175299652687560232593212131693456966318670843605238958724126368185289703563591477049105538528244632434869965333722691837462591128379816582723367039674028619947057144546</span><br>e = <span class="hljs-number">65537</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">base10</span>(<span class="hljs-params">ss</span>):<br>    r = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> ss[::-<span class="hljs-number">1</span>]:<br>        r = r * <span class="hljs-number">10</span> + x<br>    <span class="hljs-keyword">return</span> r<br>  <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dfs</span>(<span class="hljs-params">ps, qs, mod</span>):<br>    <span class="hljs-keyword">if</span> base10(ps) * base10(qs) == n:<br>        <span class="hljs-keyword">yield</span> base10(ps), base10(qs)<br>        <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">for</span> pp, qq <span class="hljs-keyword">in</span> product((<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>), (<span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>)):<br>        p = base10(ps + [pp])<br>        q = base10(qs + [qq])<br>        <span class="hljs-keyword">if</span> p * q % mod == n % mod:<br>            <span class="hljs-keyword">yield</span> <span class="hljs-keyword">from</span> dfs(ps + [pp], qs + [qq], mod * <span class="hljs-number">10</span>)<br>  <br><br>p, q = <span class="hljs-built_in">next</span>(dfs([], [], <span class="hljs-number">1</span>))<br>phi = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br>d = gmpy2.invert(e, phi)<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">XYCTF&#123;7f4b2241951976ce5ef6df44503209059997e5085d1bc21f6bef4d9effb29fd0&#125;</span><br></code></pre></td></tr></table></figure><br>参考：<a href="https://blog.maple3142.net/2024/03/03/osu-gaming-ctf-2024-writeups/#no-dorchadas">https://blog.maple3142.net/2024/03/03/osu-gaming-ctf-2024-writeups/#no-dorchadas</a></p><h3 id="Sign1n-签到-amp-Sign1n-Revenge"><a href="#Sign1n-签到-amp-Sign1n-Revenge" class="headerlink" title="Sign1n[签到] &amp; Sign1n_Revenge"></a>Sign1n[签到] &amp; Sign1n_Revenge</h3><p>两个签到的b不一样，莫非是传说中的动态附件？<br>题解就b不一样，这里就放一个的了</p><h4 id="题目：-4"><a href="#题目：-4" class="headerlink" title="题目："></a>题目：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br>flag=<span class="hljs-string">b&#x27;XYCTF&#123;uuid&#125;&#x27;</span><br>flag=bytes_to_long(flag)<br>leak=<span class="hljs-built_in">bin</span>(<span class="hljs-built_in">int</span>(flag))<br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    leak += <span class="hljs-string">&quot;0&quot;</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(leak) == <span class="hljs-number">514</span>:<br>        <span class="hljs-keyword">break</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">swap_bits</span>(<span class="hljs-params">input_str</span>):<br>    input_list = <span class="hljs-built_in">list</span>(input_str[<span class="hljs-number">2</span>:])<br>    length = <span class="hljs-built_in">len</span>(input_list)<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length // <span class="hljs-number">2</span>):<br>        temp = input_list[i]<br>        input_list[i] = input_list[length - <span class="hljs-number">1</span> - i]<br>        input_list[length - <span class="hljs-number">1</span> - i] = temp<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join(input_list)<br><br>input_str = leak<br>result = swap_bits(input_str)<br>a=result<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">custom_add</span>(<span class="hljs-params">input_str</span>):<br>    input_list = <span class="hljs-built_in">list</span>(input_str)<br>    length = <span class="hljs-built_in">len</span>(input_list)<br>    <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length):<br>        input_list[i] = <span class="hljs-built_in">str</span>((<span class="hljs-built_in">int</span>(input_list[i]) + i + <span class="hljs-number">1</span>) % <span class="hljs-number">10</span>)<br><br>    result = <span class="hljs-string">&#x27;&#x27;</span>.join(input_list)<br>    <span class="hljs-keyword">return</span> result<br><br><br>input_str = a<br>result = custom_add(input_str)<br>b=result<br><span class="hljs-built_in">print</span>(b)<br></code></pre></td></tr></table></figure><h4 id="解答：-5"><a href="#解答：-5" class="headerlink" title="解答："></a>解答：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python">b = <span class="hljs-number">12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567891134567789113445678012235677900133457889012456679901245577801223567790012355788911245667890134456789122355788001245578891223566790113445778902335578800123457889122346778011344567991223557880012346788912335667991134457789122355788001244578891223467799012455688912234667900133557889022356678901344578801233467789112355779912234577990233556780113</span><br>b = <span class="hljs-built_in">str</span>(b)<br><span class="hljs-built_in">print</span>(b)<br>  <br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">custom_add</span>(<span class="hljs-params">input_str</span>):<br>    input_list = <span class="hljs-built_in">list</span>(input_str)<br>    length = <span class="hljs-built_in">len</span>(input_list)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length):<br>        input_list[i] = <span class="hljs-built_in">str</span>((<span class="hljs-built_in">int</span>(input_list[i]) - i - <span class="hljs-number">1</span>) % <span class="hljs-number">10</span>)<br>    result = <span class="hljs-string">&#x27;&#x27;</span>.join(input_list)<br>    <span class="hljs-keyword">return</span> result[[扩展维纳攻击]]<br><br>a = custom_add(b)<br><span class="hljs-built_in">print</span>(a)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">swap_bits</span>(<span class="hljs-params">input_str</span>):<br>    input_list = <span class="hljs-built_in">list</span>(input_str[<span class="hljs-number">2</span>:])<br>    length = <span class="hljs-built_in">len</span>(input_list)<br>    <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length // <span class="hljs-number">2</span>):<br>        temp = input_list[i]<br>        input_list[i] = input_list[length - <span class="hljs-number">1</span> - i]<br>        input_list[length - <span class="hljs-number">1</span> - i] = temp<br>        <br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join(input_list)<br>f = swap_bits(a)<br><span class="hljs-built_in">print</span>(f)<br><span class="hljs-comment"># 去掉末尾的0</span><br>binary = <span class="hljs-number">0b1011000010110010100001101010100010001100111101100110000001100100011010100110010001100100110000101100011001100100010110100110001001101010011011100111000001011010011010000110110011000110011000000101101011000010011011100110011001101100010110100110000001100000011100100110100001101110011100101100001001110000011000100110111001110000011010001111101</span><br><span class="hljs-built_in">print</span>(long_to_bytes(binary))<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">b&#x27;XYCTF&#123;02522ac2-1578-46c0-a736-009479a81784&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="BabyRSAMAX"><a href="#BabyRSAMAX" class="headerlink" title="BabyRSAMAX"></a>BabyRSAMAX</h3><h4 id="题目：-5"><a href="#题目：-5" class="headerlink" title="题目："></a>题目：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> choice<br><br>flag = <span class="hljs-string">b&#x27;XYCTF&#123;******&#125;&#x27;</span><br>e = <span class="hljs-string">&#x27;?&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getBabyPrime</span>(<span class="hljs-params">nbits</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        p = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> p.bit_length() &lt;= nbits:<br>            p *= choice(sieve_base)<br>        <br>        <span class="hljs-keyword">if</span> isPrime(p+<span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">return</span> p+<span class="hljs-number">1</span><br><br>p = getBabyPrime(<span class="hljs-number">512</span>)<br>q = getBabyPrime(<span class="hljs-number">512</span>)<br>n = p*q<br>gift1 = (<span class="hljs-built_in">pow</span>(p,e,n)-<span class="hljs-built_in">pow</span>(q,e,n)) % n<br>gift2 = <span class="hljs-built_in">pow</span>(p+q,e,n)<br><br>t = <span class="hljs-number">65537</span><br>x = bytes_to_long(e)<br>y = <span class="hljs-built_in">pow</span>(x, t, n)<br><br>m = bytes_to_long(flag)<br>c = powmod(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;gift1 = <span class="hljs-subst">&#123;gift1&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;gift2 = <span class="hljs-subst">&#123;gift2&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;y = <span class="hljs-subst">&#123;y&#125;</span>&#x27;</span>)<br><br></code></pre></td></tr></table></figure><h4 id="解答：-6"><a href="#解答：-6" class="headerlink" title="解答："></a>解答：</h4><p>$g1=p^{e}-q^{e}\mod{n}$<br>$g2=(p+q)^{e}\mod{n}=p^{e}+q^{e}\mod{n}$<br>$g1+g2=2p^{e}\mod{n}$<br>$g2-g1=2q^{e}\mod{n}$<br>$\therefore p = gcd(g1+g2,n)$<br>$\therefore q = gcd(g2-g1,n)$</p><p>一路算下去发现e与phi不互素，于是模n下对c开4次方<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> choice<br><br>n = <span class="hljs-number">39332423872740210783246069030855946244104982381157166843977599780233911183158560901377359925435092326653303964261550158658551518626014048783435245471536959844874036516931542444719549997971482644905523459407775392702211086149279473784796202020281909706723380472571862792003687423791576530085747716706475220532321</span><br>g1 = <span class="hljs-number">4549402444746338327349007235818187793950285105091726167573552412678416759694660166956782755631447271662108564084382098562999950228708300902201571583419116299932264478381197034402338481872937576172197202519770782458343606060544694608852844228400457232100904217062914047342663534138668490328400022651816597367310</span><br>g2 = <span class="hljs-number">111061215998959709920736448050860427855012026815376672067601244053580566359594802604251992986382187891022583247997994146019970445247509119719411310760491983876636264003942870756402328634092146799825005835867245563420135253048223898334460067523975023732153230791136870324302259127159852763634051238811969161011462</span><br>c = <span class="hljs-number">16938927825234407267026017561045490265698491840814929432152839745035946118743714566623315033802681009017695526374397370343984360997903165842591414203197184946588470355728984912522040744691974819630118163976259246941579063687857994193309554129816268931672391946592680578681270693589911021465752454315629283033043</span><br>y = <span class="hljs-number">1813650001270967709841306491297716908969425248888510985109381881270362755031385564927869313112540534780853966341044526856705589020295048473305762088786992446350060024881117741041260391405962817182674421715239197211274668450947666394594121764333794138308442124114744892164155894256326961605137479286082964520217</span><br>  <br><br>pe = ((g1+g2)//<span class="hljs-number">2</span>)%n<br>qe = ((g2-g1)//<span class="hljs-number">2</span>)%n<br>p = gmpy2.gcd(pe,n)<br>q = gmpy2.gcd(qe,n)<br><span class="hljs-built_in">print</span>(p,q)<br><span class="hljs-built_in">print</span>(p*q==n)<br>phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>t = <span class="hljs-number">65537</span><br>x = <span class="hljs-built_in">pow</span>(y,gmpy2.invert(t,phi),n)<br>e = x<br><br><span class="hljs-built_in">print</span>(long_to_bytes(e))<br>e = <span class="hljs-number">4096</span><br>phi = phi//<span class="hljs-number">4</span><br><br><span class="hljs-comment">#sage</span><br><span class="hljs-comment">#以下是实现开二次方的函数</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">multiplication</span>(<span class="hljs-params">x1,y1,x2,y2,w,p</span>):  <br>    x=(x1*x2+y1*y2*w)%p  <br>    y=(x1*y2+x2*y1)%p  <br>    <span class="hljs-keyword">return</span> x,y  <br>  <br><span class="hljs-comment"># 获取w,使得w = -1 mod p, w是复数元的平方  </span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_w</span>(<span class="hljs-params">c,p</span>):  <br>    a=randint(<span class="hljs-number">1</span>,p)  <br>    w=<span class="hljs-built_in">pow</span>(a, <span class="hljs-number">2</span>) - c  <br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">pow</span>(w,(p - <span class="hljs-number">1</span>)//<span class="hljs-number">2</span>,p)!=p-<span class="hljs-number">1</span>:  <br>        a=randint(<span class="hljs-number">1</span>,p)  <br>        w=<span class="hljs-built_in">pow</span>(a,<span class="hljs-number">2</span>)-c  <br>    <span class="hljs-keyword">return</span> w,a  <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Cipolla_algorithm</span>(<span class="hljs-params">c,p</span>):  <br>    <span class="hljs-comment">#主体部分  </span><br>    w,a=get_w(c,p)  <br>    power=(p+<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>  <br>    x1=a  <br>    y1=<span class="hljs-number">1</span>  <br>    x=<span class="hljs-number">1</span>  <br>    y=<span class="hljs-number">0</span>  <br>    <span class="hljs-keyword">while</span>(power!=<span class="hljs-number">0</span>):  <br>        <span class="hljs-keyword">if</span>(power!=(p+<span class="hljs-number">1</span>)//<span class="hljs-number">2</span>):  <br>            x1,y1=multiplication(x1,y1,x1,y1,w,p)  <br>        <span class="hljs-keyword">if</span>(power &amp; <span class="hljs-number">1</span>):  <br>            x,y=multiplication(x,y,x1,y1,w,p)  <br>        power&gt;&gt;=<span class="hljs-number">1</span>  <br>    <span class="hljs-keyword">return</span> x<br><span class="hljs-comment">#以下sage直接对cn开两次二次方，因为只有四个解所以偷懒了</span><br>cn = <span class="hljs-built_in">pow</span>(c,<span class="hljs-number">4</span>*<span class="hljs-number">15340221468921505548397362128123138214101003260229144051087454992413006131615185800769124140840468748</span><br><span class="hljs-number">23035337005158475621433705623268639417140515158078335142054666787229183797173181186377993649280</span>,n)<br>cp = cn%p<br>Cipolla_algorithm(cn,p)%p<br><span class="hljs-number">166353789373057352195268573847472134983952212264580315606750168640904529917560511398152614100259694276272602506054433757749654828608600573448732931745676174</span><br><br>sage: Cipolla_algorithm(cn,p)%p<br><span class="hljs-number">1320925615378691609936673193334302667304516095065655944868325562479391795804424371343552922650946388889883899419614130483678902025</span><br>sage: Cipolla_algorithm(cn,p)%p<br><span class="hljs-number">166353789373057352195268573847472134983952212264580315606750168640904529917560511398152614100259694276272602506054433757749654828608600573448732931745676174</span><br>sage: Cipolla_algorithm(<span class="hljs-number">166353789373057352195268573847472134983952212264580315606750168640904529917560511398152614100259694276272602506054433757749654828608600573448732931745676174</span>,p)%p<br><span class="hljs-number">0</span><br>sage: Cipolla_algorithm(<span class="hljs-number">1320925615378691609936673193334302667304516095065655944868325562479391795804424371343552922650946388889883899419614130483678902025</span>,p)%p<br><span class="hljs-number">36344540379246669047243921781711114415694316462518391812884210045</span><br>sage: Cipolla_algorithm(<span class="hljs-number">1320925615378691609936673193334302667304516095065655944868325562479391795804424371343552922650946388889883899419614130483678902025</span>,p)%p<br><span class="hljs-number">166353789373057352195268575168397750362643822201253508941052835945420624983216456266478176543306949701450304802363434626984929302798183530544471602540368154</span><br></code></pre></td></tr></table></figure><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#长度较短的通常会是flag，直接尝试最短的，得到flag</span><br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-number">36344540379246669047243921781711114415694316462518391812884210045</span>))<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">b&#x27;XYCTF&#123;Rabin_is_so_biggggg!&#125;&#x27;</span><br></code></pre></td></tr></table></figure><br>实现开二次方的函数来源：<a href="https://www.cnblogs.com/Lovechan/articles/17517915.html">https://www.cnblogs.com/Lovechan/articles/17517915.html</a></p><h3 id="fakeRSA"><a href="#fakeRSA" class="headerlink" title="fakeRSA"></a>fakeRSA</h3><h4 id="题目：-6"><a href="#题目：-6" class="headerlink" title="题目："></a>题目：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;XYCTF&#123;******&#125;&#x27;</span><br>n = ZZ(bytes_to_long(flag))<br>p = getPrime(<span class="hljs-built_in">int</span>(<span class="hljs-number">320</span>))<br><span class="hljs-built_in">print</span>(p)<br><br>G = Zmod(p)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">function</span>(<span class="hljs-params">X, Y, Z</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">part</span>(<span class="hljs-params">a, b, c</span>):<br>        <span class="hljs-keyword">return</span> vector([<span class="hljs-number">9</span> * a - <span class="hljs-number">36</span> * c, <span class="hljs-number">6</span> * a - <span class="hljs-number">27</span> * c, b])<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">parts</span>(<span class="hljs-params">n</span>):<br>        Gx.&lt;a, b, c&gt; = G[]<br>        <span class="hljs-keyword">if</span> n == <span class="hljs-number">0</span>: <span class="hljs-keyword">return</span> vector([a, b, c])<br>        mid = parts(n // <span class="hljs-number">2</span>)<br>        result = mid(*mid)<br>        <span class="hljs-keyword">if</span> n % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>: <span class="hljs-keyword">return</span> result<br>        <span class="hljs-keyword">else</span>: <span class="hljs-keyword">return</span> part(*result)<br>    <span class="hljs-keyword">return</span> parts(n)(X, Y, Z)<br><br><span class="hljs-built_in">print</span>(function(<span class="hljs-number">69</span>, <span class="hljs-number">48</span>, <span class="hljs-number">52</span>))<br></code></pre></td></tr></table></figure><h4 id="解答：-7"><a href="#解答：-7" class="headerlink" title="解答："></a>解答：</h4><p>hint中提到jordan标准型，现学又加一</p><script type="math/tex; mode=display">f(i, a, p) = \left( \sum_{j=0}^{len(a)-1} i^j \cdot a[j] \right) \mod p</script><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>p = <span class="hljs-number">1849790472911267366045392456893126092698743308291512220657006129900961168811898822553602045875909</span><br>K = Zmod(p)<br>A = matrix(K, [[<span class="hljs-number">9</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">36</span>], [<span class="hljs-number">6</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">27</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>]])<br>u = vector(K, (<span class="hljs-number">69</span>, <span class="hljs-number">48</span>, <span class="hljs-number">52</span>))<br>v = vector(<br>    K,<br>    (<br>        <span class="hljs-number">1431995965813617415860695748430644570118959991271395110995534704629241309597572003500157255135707</span>,<br>        <span class="hljs-number">1011565891130611736600822618382801465506651972373410962205810570075870804325974377971089090196019</span>,<br>        <span class="hljs-number">784497518859893244278116222363814433595961164446277297084989532659832474887622082585456138030246</span>,<br>    ),<br>)<br>J, P = A.jordan_form(transformation=<span class="hljs-literal">True</span>)<br><span class="hljs-comment"># A^n*v=u</span><br><span class="hljs-comment"># A=PJP^-1</span><br><span class="hljs-comment"># J^n*vv=uu</span><br><span class="hljs-built_in">print</span>(J)<br>vv = ~P * v<br>uu = ~P * u<br>a, b, c = uu<br>aa, bb, cc = vv<br>n = (<span class="hljs-number">18</span> * bb * c - <span class="hljs-number">18</span> * b * cc) / (<span class="hljs-number">6</span> * c * cc)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(n)))<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">[3 1 0]</span><br><span class="hljs-string">[0 3 1]</span><br><span class="hljs-string">[0 0 3]</span><br><span class="hljs-string">b&#x27;XYCTF&#123;y0u_finally_f0und_t3h_s3cr3ts!!&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="random-rr"><a href="#random-rr" class="headerlink" title="random_rr"></a>random_rr</h3><h4 id="题目：-7"><a href="#题目：-7" class="headerlink" title="题目："></a>题目：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br>flag=<span class="hljs-string">b&#x27;XYCTF&#123;uuid&#125;&#x27;</span><br>flag = bytes_to_long(flag)<br>n = <span class="hljs-number">472993274721871037103726599805149366727531552333249750035977291933239067588481589544777397613192273114354221827196579379954069925604091911249655707080927769808587176515295614018992848517984372306879552247519117116110554431341268358177159108949791969262793325836353834899335531293329721598226413212541536002401507477776699642647348576111445702197483449777741566350285229621935507081895389023444249054515395783080003733803406382744631528246608154546123270319561514117323480441428953306734274538511770278887429407127143049023747710881993279361892937905382946820141513009017756811296722630617325141162244806884220212939955235410280899112731530527048274396186038160728562551536558223235783656985493518204710943916486379681906506757757594165379493317173050550893487151879681122510523721157284728808336110950008840684602353984682117748018347433177541603140491131603068512706893984834735290809952944273565203183330739252949245209529232254867201402656024997949207918675051941911990640248052951780195402390132237903538546705181463959793972284823588987652138458328270662652334799233015314673544813649692428544375538627858921763941533600553536579901589575693816746953261108022490849251974419402753031545629158199093099096735356165044275617408697</span><br>rr = <span class="hljs-number">11898141078345200236264081467585899457224809417108457314508072413792599039332439547789237898270544336909458761754683941320649771736625000667170176071314483</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate</span>():<br>    fw = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;random&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">648</span>):<br>        fw.write(<span class="hljs-built_in">str</span>(random.getrandbits(<span class="hljs-number">32</span>))+<span class="hljs-string">&quot;\n&quot;</span>)<br>    fw.close()<br>generate()<br>key = <span class="hljs-built_in">str</span>(random.getrandbits(<span class="hljs-number">32</span>))<br>key1= <span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(key)[<span class="hljs-number">0</span>])<br>ks = [randint(<span class="hljs-number">0</span>, rr**(i+key1-<span class="hljs-number">1</span>)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<br>c1 = <span class="hljs-built_in">pow</span>(<span class="hljs-built_in">sum</span>(k*flag**i <span class="hljs-keyword">for</span> i, k <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(ks)), <span class="hljs-number">127</span>, n)<br>c2 = <span class="hljs-built_in">pow</span>(flag, <span class="hljs-number">65537</span>, n)<br>ks = [<span class="hljs-built_in">pow</span>(<span class="hljs-number">69</span>, k+key, rr**(i+key1)) <span class="hljs-keyword">for</span> i, k <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(ks)]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;ks = &#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;c1 = &#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;c2 = &#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><h4 id="解答：-8"><a href="#解答：-8" class="headerlink" title="解答："></a>解答：</h4><p>现学<br>翻译开始：<a href="https://math.stackexchange.com/questions/1863037/discrete-logarithm-modulo-powers-of-a-small-prime">elementary number theory - Discrete logarithm modulo powers of a small prime - Mathematics Stack Exchange</a><br>首先，对于给定的小素数 ( p )，解决形如$ax \equiv b \pmod{p}$的同余方程相对容易，这里假设 ( a ) 和 ( b ) 都不是 ( p ) 的倍数。例如，对于任何偶数指数 ( x )，都有$2x \equiv 28 \pmod{3}$成立。</p><p>其次，如果对于某个整数幂$s \geq 1$，存在解$a^{x} \equiv b \pmod{p^s}$，那么解也存在于$p^{s-1}$ 中，一直回溯到 ( p )，也就是<br>$a^{x} \equiv b \pmod{p^s}⟹a^{x} \equiv b \pmod{p^{s-1}}⟹…⟹a^{x} \equiv b \pmod{p}$</p><p>Eric Bach（1984年）提出了一个类似于多项式的 Hensel 提升算法的算法，用于在上述同余方程链中向后推进。他的目的是比较对于一般模数$n$求解离散对数问题和因数分解问题的难度，所以这里我们只关注他的工作的一部分。</p><p>在此算法中，我们使用模运算下的整数环$\mathbb{Z}$，并且$\mathbb{Z}_n$表示模$n$的整数环。$\mathbb{Z}^*_n$表示其单位元的乘法群，而$\mathbb{Z}^+_n$表示其加法群。需要注意的是，加法群是循环的，有$n$个元素，而乘法群的元素个数由欧拉函数$\phi(n)$给出（计算与$n$互素的介于 0 和$n-1$的整数个数）。</p><p>接下来，考虑$n = p^s$是素数的幂次方，其中$s \geq 1$。其单位元群的元素个数可以通过以下方式计算：<script type="math/tex">\phi(p^s) = (p-1)p^{s-1}</script>对于奇素数$p$的情况，乘法群是循环的，其阶数为$(p-1)p^{s-1}$，并且存在一个模$n$的原根。</p><p>现在，Bach 从奇素数$p$的情况开始讨论，因此我们知道存在一个同构映射：</p><script type="math/tex; mode=display">\mathbb{Z}^*_{p^s} \cong \mathbb{Z}^*_p \times \mathbb{Z}^+_{p^{s-1}}</script><p>易见，对于给定的 $k \in \mathbb{Z}^<em>_{p^s}$，要找到其在第一个因子上的投影，只需将 $k$ 对 $p$ 取模即可。 剩余算法的核心在于展示一个多项式时间可计算的同态投影 $\theta$，将乘法群 $\mathbb{Z}^</em>_{p^s}$ 同态映射到加法群 $\mathbb{Z}^+_{p^{s-1}}$： <script type="math/tex">\theta: \mathbb{Z}^*_{p^s} \rightarrow \mathbb{Z}^+_{p^{s-1}}</script> 一旦我们得到了这个函数，将模 $p$ 下的解 $a^{x_{1}} \equiv b \mod p$ 提升到 $\mathbb{Z}^*_{p^s}$ 中的解 $a^{x_{s}} \equiv b \mod p^s$ 就变得相当自然。需要注意的是，$x_s \equiv x_1 \mod (p-1)$。 将投影 $\theta$ 应用到上述“高阶”同余式中，将会导向到加法群 $\mathbb{Z}^+_{p^{s-1}}$ 中的以下问题： <script type="math/tex">c \cdot \theta(a) \equiv \theta(b) \mod p^{s-1}</script> 这个问题可以通过扩展欧几里得算法，在 $\mathbb{Z}_{p^{s-1}}$ 中求解 $\theta(a)$ 的倒数来解决。 如果我们通过中国剩余定理找到一个整数 $x_s$，满足以下两个条件： <script type="math/tex">x_s \equiv x_1 \mod (p-1)</script> <script type="math/tex">x_s \equiv c \mod p^{s-1}</script> 那么我们就完成了，因为根据同构关系： <script type="math/tex">a^{x_{s}} \equiv b \mod p^s</script></p><p>最后，Bach 给出了投影函数$\theta$的公式：</p><p>$\theta(k) = \left[ \frac{k^{(p-1)p^{s-1} - 1}}{p^s} \right] \pmod{p^{s-1}}$</p><p>这个函数的复杂度在于$p$和$s$的对数阶，如果分子（方括号中整数表达式的分子）在模$p^{2s-1}$下计算，则此函数是多项式时间的。我们需要这么多的基数$p$位数，以便在除以$p^s$后得到正确的模$p^{s-1}$的余数。除法的准确性由欧拉对费马小定理的推广所暗示。</p><p><strong>因为$\phi(p^s) = (p-1)p^{s-1}$<br>所以找一个$x_s$同时满足$x_{s}\equiv x_1 \mod (p-1)$和$x_s \equiv c \mod p^{s-1}$<br>使$a^{x_{1}+k(p-1)p^{s-1}} \equiv b \mod p^s$</strong></p><p>翻译结束（）<br>以下代码</p><p>首先梅森旋转找出key</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">from</span> randcrack <span class="hljs-keyword">import</span> RandCrack<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">r&#x27;random&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    l = f.readlines()<br>l = [<span class="hljs-built_in">int</span>(i.strip()) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> l]<br>t = []<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">24</span>,<span class="hljs-number">648</span>):<br>    t.append(l[i])<br><br>rc = RandCrack()<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> t:<br>    rc.submit(i)<br>    <br>key = <span class="hljs-built_in">str</span>(rc.predict_getrandbits(<span class="hljs-number">32</span>))<br>key1= <span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(key)[<span class="hljs-number">0</span>])<br><span class="hljs-built_in">print</span>(key)<br><span class="hljs-built_in">print</span>(key1)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">3168111950</span><br><span class="hljs-string">3</span><br></code></pre></td></tr></table></figure><p>然后一个同态映射到加法群，根据c1和c2模n下构造两个多项式环，gcd得到n<br>注意最后减去k多加的key<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><code class="hljs python">ks = [...]<br>c1 = ...<br>c2 = ...<br>n = ...<br>rr = ...<br>key = <span class="hljs-number">3168111950</span><br>key1 = <span class="hljs-number">3</span><br><br><span class="hljs-comment">#sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> logging<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">_polynomial_hgcd</span>(<span class="hljs-params">ring, a0, a1</span>):<br>    <span class="hljs-keyword">assert</span> a1.degree() &lt; a0.degree()<br><br>    <span class="hljs-keyword">if</span> a1.degree() &lt;= a0.degree() / <span class="hljs-number">2</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span><br><br>    m = a0.degree() // <span class="hljs-number">2</span><br>    b0 = ring(a0.<span class="hljs-built_in">list</span>()[m:])<br>    b1 = ring(a1.<span class="hljs-built_in">list</span>()[m:])<br>    R00, R01, R10, R11 = _polynomial_hgcd(ring, b0, b1)<br>    d = R00 * a0 + R01 * a1<br>    e = R10 * a0 + R11 * a1<br>    <span class="hljs-keyword">if</span> e.degree() &lt; m:<br>        <span class="hljs-keyword">return</span> R00, R01, R10, R11<br><br>    q, f = d.quo_rem(e)<br>    g0 = ring(e.<span class="hljs-built_in">list</span>()[m // <span class="hljs-number">2</span>:])<br>    g1 = ring(f.<span class="hljs-built_in">list</span>()[m // <span class="hljs-number">2</span>:])<br>    S00, S01, S10, S11 = _polynomial_hgcd(ring, g0, g1)<br>    <span class="hljs-keyword">return</span> S01 * R00 + (S00 - q * S01) * R10, S01 * R01 + (S00 - q * S01) * R11, S11 * R00 + (S10 - q * S11) * R10, S11 * R01 + (S10 - q * S11) * R11<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">fast_polynomial_gcd</span>(<span class="hljs-params">a0, a1</span>):<br><br>    <span class="hljs-keyword">assert</span> a0.parent() == a1.parent()<br><br>    <span class="hljs-keyword">if</span> a0.degree() == a1.degree():<br>        <span class="hljs-keyword">if</span> a1 == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> a0<br>        a0, a1 = a1, a0 % a1<br>    <span class="hljs-keyword">elif</span> a0.degree() &lt; a1.degree():<br>        a0, a1 = a1, a0<br><br>    <span class="hljs-keyword">assert</span> a0.degree() &gt; a1.degree()<br>    ring = a0.parent()<br><br><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        logging.debug(<span class="hljs-string">f&quot;deg(a0) = <span class="hljs-subst">&#123;a0.degree()&#125;</span>, deg(a1) = <span class="hljs-subst">&#123;a1.degree()&#125;</span>&quot;</span>)<br>        _, r = a0.quo_rem(a1)<br>        <span class="hljs-keyword">if</span> r == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> a1.monic()<br><br>        R00, R01, R10, R11 = _polynomial_hgcd(ring, a0, a1)<br>        b0 = R00 * a0 + R01 * a1<br>        b1 = R10 * a0 + R11 * a1<br>        <span class="hljs-keyword">if</span> b1 == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> b0.monic()<br><br>        _, r = b0.quo_rem(b1)<br>        <span class="hljs-keyword">if</span> r == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> b1.monic()<br><br>        a0 = b1<br>        a1 = r<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">omega</span>(<span class="hljs-params">x, p, e</span>):<br>    numerator = (<span class="hljs-built_in">pow</span>(x, (p - <span class="hljs-number">1</span>) * p**(e-<span class="hljs-number">1</span>), p**(<span class="hljs-number">2</span> * e - <span class="hljs-number">1</span>)) - <span class="hljs-number">1</span>) % p**(<span class="hljs-number">2</span> * e - <span class="hljs-number">1</span>)<br>    denominator = <span class="hljs-built_in">pow</span>(p, e)<br>    ans = (<span class="hljs-built_in">int</span>(numerator) // <span class="hljs-built_in">int</span>(denominator)) % p**(e-<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">return</span> ans<br><br>coeff = []<br><span class="hljs-keyword">for</span> i, k <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(ks):<br>    base = omega(<span class="hljs-number">69</span>, rr, i+key1)<br>    target = omega(k, rr, i+key1)<br>    kk = target * gmpy2.invert(base, rr**(i + key1 - <span class="hljs-number">1</span>)) % rr**(i + key1 - <span class="hljs-number">1</span>)-key<span class="hljs-comment">#多了个key要在这里减掉</span><br><br>    coeff.append(kk)<br><br>x = PolynomialRing(Zmod(n), <span class="hljs-string">&#x27;x&#x27;</span>).gen()<br><br>f1 = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i, k <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(coeff):<br>    f1 += k*x**i<br><br>f1 = f1**<span class="hljs-number">127</span> - c1<br>f2 = x**<span class="hljs-number">65537</span> - c2<br><br>h = fast_polynomial_gcd(f1, f2)<br>m = -h[<span class="hljs-number">0</span>] / h[<span class="hljs-number">1</span>]<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(m)))<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">b&#x27;XYCTF&#123;ba76e13f-269e-4481-baf0-4a50ad17f891&#125;&#x27;</span><br></code></pre></td></tr></table></figure><br>参考：<a href="https://giapppp.github.io/posts/bi0s/#2%20rr">bi0sCTF 2024 - Giap’s Blog (giapppp.github.io)</a></p><h3 id="LCG-and-HNP"><a href="#LCG-and-HNP" class="headerlink" title="LCG_and_HNP"></a>LCG_and_HNP</h3><p>花了一天多的时间认真啃了啃LCG</p><script type="math/tex; mode=display">\begin{align}&s_{n+1}=as_{n}+b\mod{p}\\&拆分高低位，s_{n}=h_{n}+l_{n}\\&h_{n+1}+l_{n+1}=a(h_{n}+l_{n})+b\mod{p}\\&l_{n+1}=al_{n}+ah_{n}+b-h_{n+1}\mod{p}\\&l_{n+2}=al_{n+1}+ah_{n+1}+b-h_{n+2}\mod{p}\\&\therefore l_{n+2}=al_{n}+a(ah_{n}+b-h_{n+1})+(ah_{n+1}+b-h_{n+2})\mod{p}\\&构造A ,B\\&l_{n+1}= A_{n}+b_{n}+k_{n}m\\&构造lattice\end{align}</script><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br>p=<span class="hljs-number">183640370379099520304414468793633666661</span><br>a=<span class="hljs-number">36108041497607074474855679331694767924</span><br>b=<span class="hljs-number">65925932211985158779695144876342622462</span><br>out=[<span class="hljs-number">34</span>, <span class="hljs-number">95</span>, <span class="hljs-number">100</span>, <span class="hljs-number">114</span>, <span class="hljs-number">16</span>, <span class="hljs-number">23</span>, <span class="hljs-number">17</span>, <span class="hljs-number">118</span>, <span class="hljs-number">115</span>, <span class="hljs-number">29</span>, <span class="hljs-number">73</span>, <span class="hljs-number">47</span>, <span class="hljs-number">12</span>, <span class="hljs-number">133</span>, <span class="hljs-number">78</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">73</span>, <span class="hljs-number">87</span>, <span class="hljs-number">15</span>, <span class="hljs-number">85</span>, <span class="hljs-number">47</span>, <span class="hljs-number">20</span>, <span class="hljs-number">136</span>, <span class="hljs-number">6</span>, <span class="hljs-number">106</span>, <span class="hljs-number">74</span>, <span class="hljs-number">27</span>, <span class="hljs-number">116</span>, <span class="hljs-number">8</span>]<br>c=<span class="hljs-number">6003642257316152022364486167163125577018867662610595926973616937741281227891381713617380</span><br><br>out.insert(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(out)):<br>    out[i] &lt;&lt;= <span class="hljs-number">120</span><br>A = [<span class="hljs-number">1</span>]<br>B = [<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(out)-<span class="hljs-number">1</span>):<br>    A.append(a*A[i-<span class="hljs-number">1</span>] % p)<br>    B.append((a*B[i-<span class="hljs-number">1</span>]+a*out[i]+b-out[i+<span class="hljs-number">1</span>]) % p)<br>A = A[<span class="hljs-number">1</span>:]<br>B = B[<span class="hljs-number">1</span>:]<br><br>Ai = matrix(A)<br>Bi = matrix(B)<br>Mi = matrix.identity(<span class="hljs-built_in">len</span>(out)-<span class="hljs-number">2</span>)*p<br>K = ZZ(<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,<span class="hljs-number">128</span>-<span class="hljs-number">8</span>))<br>M = matrix.block([[Mi,ZZ(<span class="hljs-number">0</span>),ZZ(<span class="hljs-number">0</span>)],[Ai,ZZ(<span class="hljs-number">1</span>),ZZ(<span class="hljs-number">0</span>)],[Bi,ZZ(<span class="hljs-number">0</span>),K]])<br><br>ll = M.LLL()[<span class="hljs-number">0</span>]<br>l1 = ll[-<span class="hljs-number">2</span>]<br>h1 = out[<span class="hljs-number">1</span>]<br>s1 = l1+h1<br><span class="hljs-comment">#for s1=a*seed+b%m</span><br>seed = ((s1-b)*inverse_mod(a,p))%p<br><span class="hljs-built_in">print</span>(seed)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">98265113854859913689289076942864611315</span><br></code></pre></td></tr></table></figure><p>土法炼钢的又一天</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python">seed = <span class="hljs-number">98265113854859913689289076942864611315</span><br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LCG</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, seed, a, b, p</span>):<br>        self.seed = seed<br>        self.a = a<br>        self.b = b<br>        self.p = p<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>        self.seed = (self.seed * self.a + self.b) % self.p<br>        <span class="hljs-keyword">return</span> self.seed &gt;&gt; (self.p.bit_length() - <span class="hljs-number">8</span>)<br>  <br>p=<span class="hljs-number">183640370379099520304414468793633666661</span><br>a=<span class="hljs-number">36108041497607074474855679331694767924</span><br>b=<span class="hljs-number">65925932211985158779695144876342622462</span><br>c=<span class="hljs-number">6003642257316152022364486167163125577018867662610595926973616937741281227891381713617380</span><br>  <br>out = []<br>lcg = LCG(seed, a, b, p)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">30</span>):<br>    out.append(lcg.<span class="hljs-built_in">next</span>())<br>key = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    key += <span class="hljs-built_in">str</span>(lcg.<span class="hljs-built_in">next</span>())<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(key) &gt;= c:<br>        <span class="hljs-keyword">break</span><br><br><span class="hljs-built_in">print</span>(long_to_bytes(c^<span class="hljs-built_in">int</span>(key)))<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">b&#x27;XYCTF&#123;2h1_21_ZHi_5h0u_yU_zI_xI3_l@0&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="九转第八层压缩包密码"><a href="#九转第八层压缩包密码" class="headerlink" title="九转第八层压缩包密码"></a>九转第八层压缩包密码</h3><h4 id="题目：-8"><a href="#题目：-8" class="headerlink" title="题目："></a>题目：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long, getPrime<br>flag=<span class="hljs-string">b&quot;password&#123;xxxxx&#125;&quot;</span><br>p,q= getPrime(<span class="hljs-number">1024</span>),getPrime(<span class="hljs-number">1024</span>)<br>n = p * q<br>e = <span class="hljs-number">65537</span><br>m = bytes_to_long(flag)<br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n=&quot;</span>,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c=&quot;</span>,c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p^q=&quot;</span>,p^q)<br></code></pre></td></tr></table></figure><h4 id="解答：-9"><a href="#解答：-9" class="headerlink" title="解答："></a>解答：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python">n= <span class="hljs-number">22424440693845876425615937206198156323192795003070970628372481545586519202571910046980039629473774728476050491743579624370862986329470409383215065075468386728605063051384392059021805296376762048386684738577913496611584935475550170449080780985441748228151762285167935803792462411864086270975057853459586240221348062704390114311522517740143545536818552136953678289681001385078524272694492488102171313792451138757064749512439313085491407348218882642272660890999334401392575446781843989380319126813905093532399127420355004498205266928383926087604741654126388033455359539622294050073378816939934733818043482668348065680837</span><br>c= <span class="hljs-number">1400352566791488780854702404852039753325619504473339742914805493533574607301173055448281490457563376553281260278100479121782031070315232001332230779334468566201536035181472803067591454149095220119515161298278124497692743905005479573688449824603383089039072209462765482969641079166139699160100136497464058040846052349544891194379290091798130028083276644655547583102199460785652743545251337786190066747533476942276409135056971294148569617631848420232571946187374514662386697268226357583074917784091311138900598559834589862248068547368710833454912188762107418000225680256109921244000920682515199518256094121217521229357</span><br>leak = <span class="hljs-number">14488395911544314494659792279988617621083872597458677678553917360723653686158125387612368501147137292689124338045780574752580504090309537035378931155582239359121394194060934595413606438219407712650089234943575201545638736710994468670843068909623985863559465903999731253771522724352015712347585155359405585892</span><br>e = <span class="hljs-number">65537</span><br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pq_high_xor</span>():<br>    stack = [(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>)]  <span class="hljs-comment"># Initialize stack with starting parameters</span><br>    <span class="hljs-keyword">while</span> stack:<br>        lp, lq, p, q = stack.pop()<br>        tp0 = <span class="hljs-built_in">int</span>(p + (<span class="hljs-number">1024</span>-lp) * <span class="hljs-string">&quot;0&quot;</span>, <span class="hljs-number">2</span>)<br>        tq0 = <span class="hljs-built_in">int</span>(q + (<span class="hljs-number">1024</span>-lq) * <span class="hljs-string">&quot;0&quot;</span>, <span class="hljs-number">2</span>)<br>        tp1 = <span class="hljs-built_in">int</span>(p + (<span class="hljs-number">1024</span>-lp) * <span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-number">2</span>)<br>        tq1 = <span class="hljs-built_in">int</span>(q + (<span class="hljs-number">1024</span>-lq) * <span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-number">2</span>)<br><br>        <span class="hljs-keyword">if</span> tp0 * tq0 &gt; n <span class="hljs-keyword">or</span> tp1 * tq1 &lt; n:<br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">if</span> lp == leak_bits:<br>            pq.append(tp0)<br>            <span class="hljs-keyword">continue</span><br><br>        <span class="hljs-keyword">if</span> xor[lp] == <span class="hljs-string">&quot;1&quot;</span>:<br>            stack.append((lp+<span class="hljs-number">1</span>, lq+<span class="hljs-number">1</span>, p + <span class="hljs-string">&quot;0&quot;</span>, q + <span class="hljs-string">&quot;1&quot;</span>))<br>            stack.append((lp+<span class="hljs-number">1</span>, lq+<span class="hljs-number">1</span>, p + <span class="hljs-string">&quot;1&quot;</span>, q + <span class="hljs-string">&quot;0&quot;</span>))<br>        <span class="hljs-keyword">else</span>:<br>            stack.append((lp+<span class="hljs-number">1</span>, lq+<span class="hljs-number">1</span>, p + <span class="hljs-string">&quot;0&quot;</span>, q + <span class="hljs-string">&quot;0&quot;</span>))<br>            stack.append((lp+<span class="hljs-number">1</span>, lq+<span class="hljs-number">1</span>, p + <span class="hljs-string">&quot;1&quot;</span>, q + <span class="hljs-string">&quot;1&quot;</span>))<br><br>leak_bits = <span class="hljs-number">1024</span><br>xor = <span class="hljs-built_in">bin</span>(leak)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">1024</span>)<br>pq = []<br>pq_high_xor()<br><br>p = <span class="hljs-built_in">int</span>(pq[<span class="hljs-number">0</span>])<br>q = <span class="hljs-built_in">int</span>(pq[<span class="hljs-number">1</span>])<br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = gmpy2.invert(e,phi)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c,d,n)))<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">b&#x27;password&#123;pruning_algorithm&#125;&#x27;</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><h3 id="九转第九层压缩包密码"><a href="#九转第九层压缩包密码" class="headerlink" title="九转第九层压缩包密码"></a>九转第九层压缩包密码</h3><h4 id="题目：-9"><a href="#题目：-9" class="headerlink" title="题目："></a>题目：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n = p * q<br>e = <span class="hljs-number">65537</span><br><br><span class="hljs-built_in">list</span> = []<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>):<br>    a, b = randint(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>**<span class="hljs-number">8</span>), randint(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>**<span class="hljs-number">256</span>)<br>    <span class="hljs-built_in">list</span>.append(a * p + b * q)<br><br>password = <span class="hljs-string">b&quot;xxxxx&quot;</span><br>c = <span class="hljs-built_in">pow</span>(bytes_to_long(password), e, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;n = &#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;c = &#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;<span class="hljs-built_in">list</span> = &#125;</span>&#x27;</span>)<br><br></code></pre></td></tr></table></figure><h4 id="解答：-10"><a href="#解答：-10" class="headerlink" title="解答："></a>解答：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> math<br>n = <span class="hljs-number">107803636687595025440095910573280948384697923215825513033516157995095253288310988256293799364485832711216571624134612864784507225218094554935994320702026646158448403364145094359869184307003058983513345331145072159626461394056174457238947423145341933245269070758238088257304595154590196901297344034819899810707</span><br>c = <span class="hljs-number">46049806990305232971805282370284531486321903483742293808967054648259532257631501152897799977808185874856877556594402112019213760718833619399554484154753952558768344177069029855164888168964855258336393700323750075374097545884636097653040887100646089615759824303775925046536172147174890161732423364823557122495</span><br><span class="hljs-built_in">list</span> = [<span class="hljs-number">618066045261118017236724048165995810304806699407382457834629201971935031874166645665428046346008581253113148818423751222038794950891638828062215121477677796219952174556774639587782398862778383552199558783726207179240239699423569318</span>, <span class="hljs-number">837886528803727830369459274997823880355524566513794765789322773791217165398250857696201246137309238047085760918029291423500746473773732826702098327609006678602561582473375349618889789179195207461163372699768855398243724052333950197</span>]<br>ab = <span class="hljs-built_in">list</span>[<span class="hljs-number">1</span>]-<span class="hljs-built_in">list</span>[<span class="hljs-number">0</span>]<br>l0 = <span class="hljs-built_in">list</span>[<span class="hljs-number">0</span>]<br>l1 = <span class="hljs-built_in">list</span>[<span class="hljs-number">1</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>**<span class="hljs-number">8</span>):<br>    t1=l1*i<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>**<span class="hljs-number">8</span>):<br>        t0 = l0*j<br>        <span class="hljs-keyword">if</span> gmpy2.gcd(<span class="hljs-built_in">abs</span>(t1-t0),n) != <span class="hljs-number">1</span>:<br>            p = gmpy2.gcd(<span class="hljs-built_in">abs</span>(t1-t0),n)<br>            <span class="hljs-keyword">break</span><br><br>e = <span class="hljs-number">65537</span><br>q = n//p<br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = gmpy2.invert(e,phi)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c,d,n)))<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">b&#x27;game_over&#x27;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>LCG</title>
    <link href="/2024/04/26/LCG/"/>
    <url>/2024/04/26/LCG/</url>
    
    <content type="html"><![CDATA[<blockquote><p>LCG，线性同余生成器</p></blockquote><h3 id="principle"><a href="#principle" class="headerlink" title="principle"></a>principle</h3><p>递归公式<script type="math/tex">s_{n+1}=as_n+b\mod{p}</script></p><p>若$gcd(a,p)=1$,则周期$T=ord(a)$</p><p>因此选取系数时应尽量使得a为模m的原根，以此尽量延长LCG周期，使$T=phi(p)$</p><h3 id="Crack-methods"><a href="#Crack-methods" class="headerlink" title="Crack methods"></a>Crack methods</h3><h4 id="unknown-a-b"><a href="#unknown-a-b" class="headerlink" title="unknown a,b"></a>unknown a,b</h4><blockquote><p>已知：m,s0,s1,s2</p></blockquote><script type="math/tex; mode=display">\begin{align}\because s_{1} &= a * s_{0} + b \pmod m\\s_{2} &= a * s_{1} + b\pmod m\\\therefore s_{2} - s_{1} &= a * s_{1} - s_{0}\pmod m\\a &= \frac{s_{2} - s_{1} }{s_{1} - s_{0}}\pmod{p}\end{align}</script><p>以下是另一种利用格密码的解法：</p><blockquote><p>一组求模等式方程组的通法，基于LLL，对构造的格基进行约化</p></blockquote><script type="math/tex; mode=display">\left[\matrix{a&b&1&k_{1}&k_{2}}\right] \left[\matrix{s_{0}&s_{1}&\frac{1}{m}&0&0\\1&1&0&\frac{1}{m}&0\\-s_{1}&-s_{2}&0&0&1\\m&0&0&0&0\\0&m&0&0&0}\right]</script><p>因此我们要找到格基约化后一个行向量，满足前两个元素为0</p><blockquote><p>为了在约化后的矩阵中得到直观的a, b，邻接上一个$\frac{E}{m}$（这里不用单位矩阵E的原因，是因为最好使得包含a(-a),b(-b)的行向量的长度尽可能短，也就是说更大的分母也是允许的</p></blockquote><p>在LLL约化后，找到满足下列要求的行向量r，即求解成功：</p><ul><li>r[0] = r[1] = 0</li><li>r[-1] = 1(-1)<br>𝑚⋅𝑟[2]=𝑎(−𝑎),𝑚⋅𝑟[3]=𝑏(−𝑏)</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br>A = Matrix([  <br>    [s0  ,s1  ,<span class="hljs-number">1</span>/m ,<span class="hljs-number">0</span>   ,<span class="hljs-number">0</span>   ],  <br>    [<span class="hljs-number">1</span>   ,<span class="hljs-number">1</span>   ,<span class="hljs-number">0</span>   ,<span class="hljs-number">1</span>/m ,<span class="hljs-number">0</span>   ],  <br>    [-s1 ,-s2 ,<span class="hljs-number">0</span>   ,<span class="hljs-number">0</span>   ,<span class="hljs-number">1</span>   ],  <br>    [m   ,<span class="hljs-number">0</span>   ,<span class="hljs-number">0</span>   ,<span class="hljs-number">0</span>   ,<span class="hljs-number">0</span>   ],  <br>    [<span class="hljs-number">0</span>   ,m   ,<span class="hljs-number">0</span>   ,<span class="hljs-number">0</span>   ,<span class="hljs-number">0</span>   ]  <br>])  <br>A = A.LLL()  <br>a = <span class="hljs-literal">None</span>  <br>b = <span class="hljs-literal">None</span>  <br><span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> A:  <br>    <span class="hljs-keyword">if</span> l[<span class="hljs-number">0</span>] == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> l[<span class="hljs-number">1</span>] == <span class="hljs-number">0</span>:  <br>        <span class="hljs-keyword">if</span> l[-<span class="hljs-number">1</span>] == <span class="hljs-number">1</span>:  <br>            a, b = l[<span class="hljs-number">2</span>] * m, l[<span class="hljs-number">3</span>] * m  <br>        <span class="hljs-keyword">elif</span> l[-<span class="hljs-number">1</span>] == -<span class="hljs-number">1</span>:  <br>            a, b = -l[<span class="hljs-number">2</span>] * m, -l[<span class="hljs-number">3</span>] * m  <br>        <span class="hljs-keyword">else</span>:  <br>            <span class="hljs-keyword">continue</span>  <br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> a <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> b:  <br>    <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;[*] No solves&quot;</span>)  <br>a %= m  <br>b %= m<br></code></pre></td></tr></table></figure><h4 id="unknown-a-b-p"><a href="#unknown-a-b-p" class="headerlink" title="unknown a,b,p"></a>unknown a,b,p</h4><blockquote><p>已知$s_{0}$~$s_6$</p></blockquote><p>令​<script type="math/tex">\begin{align}T_{n}&=s_{n+1}-s_{n}\\T_{n+1} &= S_{n+2} - S_{n+1} = a(S_{n+1} - S_{n})= aT_{n}\pmod p\\T_{n+2} &= S_{n+3} - S_{n+2} = at(S_{n+2} - S_{n+1}) = aT_{n+1} = a^{2}T_{n}\pmod p\\\therefore T_{n}T_{n+2} &- T_{n+1}^{2} = 0\pmod p\end{align}</script><br>既然$T_{n}T_{n+2} - T_{n+1}^{2}=kp$, 那么可以尝试gcd一连串的$T_{n}T_{n+2} - T_{n+1}^{2}$来找到p<br>此时问题就转化为unknown(a,b)</p><h3 id="LCG-LLBP"><a href="#LCG-LLBP" class="headerlink" title="LCG_LLBP"></a>LCG_LLBP</h3><blockquote><p>结合HNP的LCG，seed高位泄露</p></blockquote><p>这个问题一般给出了a，b，m和一组连续的seed的高位</p><script type="math/tex; mode=display">\begin{align}&s_{n+1}=as_{n}+b\mod{p}\\&拆分高低位，s_{n}=h_{n}+l_{n}\\&h_{n+1}+l_{n+1}=a(h_{n}+l_{n})+b\mod{p}\\&l_{n+1}=al_{n}+ah_{n}+b-h_{n+1}\mod{p}\\&l_{n+2}=al_{n+1}+ah_{n+1}+b-h_{n+2}\mod{p}\\&\therefore l_{n+2}=al_{n}+a(ah_{n}+b-h_{n+1})+(ah_{n+1}+b-h_{n+2})\mod{p}\\&构造A ,B\\&l_{n+1}= A_{n}+b_{n}+k_{n}m\\&构造lattice\\&\left[\matrix{p&\\&p\\\vdots&\vdots&\ddots\\A_{1}&A_{2}&\cdots&1&0\\B_{1}&B_{2}&\cdots&0&2^{lbit}}\right]\end{align}</script><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br>p=...<br>a=...<br>b=...<br>s=[...]<br>lbit=...<br><br>s.insert(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>) <span class="hljs-comment">#添上未输出s0 = 0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s)):<br>    out[i] &lt;&lt;= lbit<br>A = [<span class="hljs-number">1</span>]<br>B = [<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(s)-<span class="hljs-number">1</span>):<br>    A.append(a*A[i-<span class="hljs-number">1</span>] % p)<br>    B.append((a*B[i-<span class="hljs-number">1</span>]+a*s[i]+b-s[i+<span class="hljs-number">1</span>]) % p)<br>A = A[<span class="hljs-number">1</span>:]<br>B = B[<span class="hljs-number">1</span>:]<br><br>Ai = matrix(A)<br>Bi = matrix(B)<br>Mi = matrix.identity(<span class="hljs-built_in">len</span>(s)-<span class="hljs-number">1</span>)*p<br>K = ZZ(<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,lbit))<br>M = matrix.block([[Mi,ZZ(<span class="hljs-number">0</span>),ZZ(<span class="hljs-number">0</span>)],[Ai,ZZ(<span class="hljs-number">1</span>),ZZ(<span class="hljs-number">0</span>)],[Bi,ZZ(<span class="hljs-number">0</span>),K]])<br><br>ll = M.LLL()[<span class="hljs-number">0</span>]<br>l1 = ll[-<span class="hljs-number">2</span>]<br>h1 = out[<span class="hljs-number">1</span>]<br>s1 = l1+h1<br><span class="hljs-comment">#for s1=a*seed+b%m</span><br>seed = ((s1-b)*inverse_mod(a,p))%p<br><span class="hljs-built_in">print</span>(seed)<br><br></code></pre></td></tr></table></figure><p>得到seed之后就可以直接推测next了</p><p>参考<a href="https://dunkirkturbo.github.io/2020/03/27/Summary-of-Crypto-in-CTF-PRNG/">Summary-of-Crypto-in-CTF(PRNG) | 0xDktb’s Blog (dunkirkturbo.github.io)</a><br><a href="https://blog.csdn.net/weixin_45883223/article/details/115299389">LCG(线性同余生成器)-CSDN博客</a><br><a href="https://hasegawaazusa.github.io/hidden-number-problem.html#llbp%E7%BA%BF%E6%80%A7%E4%BD%8D%E6%B3%84%E9%9C%B2%E9%97%AE%E9%A2%98">| 独奏の小屋 (hasegawaazusa.github.io)</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>一个小小的pwntools交互</title>
    <link href="/2024/03/31/%E4%B8%80%E4%B8%AA%E5%B0%8F%E5%B0%8F%E7%9A%84pwntools%E4%BA%A4%E4%BA%92/"/>
    <url>/2024/03/31/%E4%B8%80%E4%B8%AA%E5%B0%8F%E5%B0%8F%E7%9A%84pwntools%E4%BA%A4%E4%BA%92/</url>
    
    <content type="html"><![CDATA[<p>又名试图学习出题·杂记</p><p>Pwntools远程交互相关库函数：<br>    <a href="https://blog.csdn.net/DARKNOTES/article/details/124282024">[Tools]Pwn中用于远程交互的库函数总结_python pwn remote函数、-CSDN博客</a></p><h3 id="sever"><a href="#sever" class="headerlink" title="sever"></a>sever</h3><h4 id="主体"><a href="#主体" class="headerlink" title="主体"></a>主体</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> sha256<br><span class="hljs-keyword">import</span> socketserver<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> FLAG<br><span class="hljs-keyword">import</span> signal<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> os<br><br>flag = FLAG<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span>(socketserver.BaseRequestHandler):<br><br>    ctry = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_recvall</span>(<span class="hljs-params">self</span>):<br>        BUFF_SIZE = <span class="hljs-number">2048</span><br>        data = <span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            part = self.request.recv(BUFF_SIZE)<br>            data += part<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(part) &lt; BUFF_SIZE:<br>                <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">return</span> data.strip()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send</span>(<span class="hljs-params">self, msg, newline=<span class="hljs-literal">True</span></span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> newline:<br>                msg += <span class="hljs-string">b&#x27;\n&#x27;</span><br>            self.request.sendall(msg)<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br>        <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">recv</span>(<span class="hljs-params">self, prompt=<span class="hljs-string">b&#x27;[-] &#x27;</span></span>):<br>        self.send(prompt, newline=<span class="hljs-literal">False</span>)<br>        <span class="hljs-keyword">return</span> self._recvall()<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">proof_of_work</span>(<span class="hljs-params">self</span>):<br>        random.seed(os.urandom(<span class="hljs-number">8</span>))<br>        proof = <span class="hljs-string">&#x27;&#x27;</span>.join(<br>            [random.choice(string.ascii_letters+string.digits) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>)])<br>        _hexdigest = sha256(proof.encode()).hexdigest()<br>        self.send(<span class="hljs-string">f&quot;[+] sha256(XXXX+<span class="hljs-subst">&#123;proof[<span class="hljs-number">4</span>:]&#125;</span>) == <span class="hljs-subst">&#123;_hexdigest&#125;</span>&quot;</span>.encode())<br>        x = self.recv(prompt=<span class="hljs-string">b&#x27;[+] Plz tell me XXXX: &#x27;</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(x) != <span class="hljs-number">4</span> <span class="hljs-keyword">or</span> sha256(x+proof[<span class="hljs-number">4</span>:].encode()).hexdigest() != _hexdigest:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>   <br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle</span>(<span class="hljs-params">self</span>):<br>        signal.alarm(<span class="hljs-number">60</span>)<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.proof_of_work():<br>                self.send(<span class="hljs-string">b&#x27;[!] Wrong!&#x27;</span>)<br>                <span class="hljs-keyword">return</span><br>        <br>            signal.alarm(<span class="hljs-number">300</span>)<br>            self.send(<span class="hljs-string">b&#x27;[+] &#x27;</span>)<br>            <span class="hljs-keyword">while</span> self.ctry &lt; <span class="hljs-number">35</span>: <br>                data = self.recv().decode()<br>                f = self.oraicle(data)<br>                self.send(f)<br>                self.ctry += <span class="hljs-number">1</span> <br><br>        <span class="hljs-keyword">except</span> TimeoutError:<br>            self.send(<span class="hljs-string">b&#x27;[!] Timeout occurred!&#x27;</span>)<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">oraicle</span>(<span class="hljs-params">self,a</span>):<br><br>        <span class="hljs-keyword">if</span> a.isdigit() <span class="hljs-keyword">and</span> <span class="hljs-built_in">int</span>(a)&lt;<span class="hljs-number">33</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">int</span>(a)&gt;<span class="hljs-number">0</span>:<br>            a = <span class="hljs-built_in">int</span>(a)-<span class="hljs-number">1</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-string">b&#x27;[+] &#x27;</span> + flag[a].encode()<br>        <br>        <span class="hljs-keyword">return</span>  <span class="hljs-string">b&#x27;[!] Invalid Member!&#x27;</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    HOST,PORT = <span class="hljs-string">&#x27;0.0.0.0&#x27;</span>,<span class="hljs-number">12321</span><br>    server = ForkedServer((HOST,PORT),Task)<br>    server.allow_reuse_address = <span class="hljs-literal">True</span><br>    <span class="hljs-built_in">print</span>(HOST, PORT)<br>    server.serve_forever()<br><br></code></pre></td></tr></table></figure><h4 id="杂"><a href="#杂" class="headerlink" title="杂"></a>杂</h4><p><strong>许多的ai原话</strong></p><p>在使用 <code>socketserver.BaseRequestHandler</code> 创建服务器时，通常不需要显式地关闭套接字，因为 <code>socketserver</code> 模块会自动管理套接字的关闭。当客户端断开连接或者出现异常时，<code>socketserver</code> 会在适当的时候自动关闭与客户端相关的套接字。<br>因此，在这种情况下，通常不需要显式地在 <code>finally: client_socket.close()</code> 中关闭套接字。</p><p>在 Python 中，<code>socketserver.BaseRequestHandler</code> 类是处理客户端请求的基类。在服务器端处理客户端请求时，每次客户端连接到服务器时，<code>socketserver</code> 库都会创建一个新的 <code>BaseRequestHandler</code> 类的实例来处理与该客户端的通信。<br>在 <code>BaseRequestHandler</code> 类的实例中，<code>self.request</code> 属性代表与客户端连接的套接字对象。通过这个套接字对象，服务器可以与客户端进行通信，包括接收客户端发送的数据.<br>因此，<code>self.request.recv()</code> 表示从客户端套接字对象中接收数据。在上面的代码中，<code>self.request.recv()</code> 用于接收客户端发送的数据，然后进行处理以完成任务验证（Proof of Work）。</p><p>中断服务器用<code>CTRL+C</code>，<code>CTRL+Z</code>是暂停进程，会占用端口。</p><p>在网络通信中，数据的传输可以是字节流（byte stream）或者字符流（character stream）。<br>     字节流（Byte Stream）：字节流是指一系列连续的字节，以二进制形式传输。在网络通信中，数据通常以字节流的形式传输。字节流可以包含任意类型的数据，包括文本、图像、音频等。在 Python 中，字节流通常使用 <code>bytes</code> 类型来表示。<br>     字符流（Character Stream）： 字符流是指一系列连续的字符，通常使用字符编码（如 ASCII、UTF-8 等）来表示文本数据。字符流通常用于文本文件的读写，以及与用户交互的过程中。在 Python 中，字符流通常使用 <code>str</code> 类型来表示。<br>    在网络通信中，如果需要传输文本数据，可以将文本转换为字节流进行传输，接收方再将接收到的字节流转换回文本。这样可以确保数据在传输过程中的完整性和准确性。可以使用编码（encode）和解码（decode）来在字符流和字节流之间进行转换。<br>    在Python中，b’’表示的是字节字符串（byte string），也称为字节流（byte stream）。<br>    a.isdigit()，判断是否可以转换为有效整数。只有有效整数才能使用int强制类型转换。</p><p>Signal 信号量：发送定时信号<code>single.alarm()</code>，如<code>signal.alarm(60)</code>计时60秒（被用来设置一个60秒的闹钟，在60秒后会向当前进程发送一个闹钟信号），<code>signal.alarm(0)</code>清除定时。<br>具体来说，当 <code>signal.alarm(60)</code> 被设置后，程序运行到 <code>handle</code> 方法中的任何代码时都会开始计时，60秒后如果没有取消或重置计时器，就会触发 <code>SIGALRM</code> 信号。而 <code>signal.alarm(0)</code> 的作用是取消当前正在运行的 <code>alarm</code> 计时器，如果之前设置了 <code>alarm</code>，那么它就会被取消，不会再触发超时。</p><h3 id="exp？"><a href="#exp？" class="headerlink" title="exp？"></a>exp？</h3><p>从网络接收到数据时，通常是以字节数据的形式表示的。如果你需要将这些字节数据转换为字符串以便于处理或展示，就可以使用 <code>.decode()</code> 方法。</p><p>[+]sha256(XXXX+JaakUDSfxkW0xjzV) == 4dbfdc61cb88f5bd08d87493ac62e5ab174780f5f019051f91df8b3c36564ed0<br>[+]Plz tell me XXXX:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python">table = ascii_letters + digits<br><span class="hljs-comment">#包含所有字母和数字</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solve</span>():<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.sh = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">8899</span>) <br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">proof_of_work</span>(<span class="hljs-params">self</span>):<br>        proof = self.sh.recvuntil(<span class="hljs-string">b&#x27;[+] Plz tell me XXXX:&#x27;</span>)<br><span class="hljs-comment">#接收致至&#x27;[+] Plz tell me X<span class="hljs-doctag">XXX:</span>&#x27;，也就是接收第一排</span><br>        tail = proof[<span class="hljs-number">16</span>:<span class="hljs-number">32</span>].decode()<br>        _<span class="hljs-built_in">hash</span> = proof[<span class="hljs-number">37</span>:<span class="hljs-number">101</span>].decode()<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> product(table, repeat=<span class="hljs-number">4</span>):<br><span class="hljs-comment">#itertools.product，接受多个可迭代对象作为参数，并返回一个迭代器，该迭代器产生所有输入可迭代对象的笛卡尔积</span><br><span class="hljs-comment">#笛卡尔积就是四个位置所有table包含的字符排列组合，离散数学里的</span><br>            head = <span class="hljs-string">&#x27;&#x27;</span>.join(i)<br>            t = hashlib.sha256((head + tail).encode()).hexdigest()  <span class="hljs-comment">#注意是16进制</span><br>            <span class="hljs-keyword">if</span> t == _<span class="hljs-built_in">hash</span>:<br>                self.sh.sendline(head.encode())<br>                <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><pre><code class="hljs">不要老是忘了def个函数括号里丢一个self（小声嘀咕）</code></pre><p>proof结束</p><h4 id="主体-1"><a href="#主体-1" class="headerlink" title="主体"></a>主体</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> string <span class="hljs-keyword">import</span> ascii_letters, digits<br><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> product<br>table = ascii_letters + digits<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solve</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.sh = remote(<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>, <span class="hljs-number">12321</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">proof_of_work</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># [+] sha256(XXXX+JaakUDSfxkW0xjzV) == 4dbfdc61cb88f5bd08d87493ac62e5ab174780f5f019051f91df8b3c36564ed0</span><br>        <span class="hljs-comment"># [+] Plz tell me X<span class="hljs-doctag">XXX:</span></span><br>        proof = self.sh.recvuntil(<span class="hljs-string">b&#x27;[+] Plz tell me XXXX:&#x27;</span>)<br>        tail = proof[<span class="hljs-number">16</span>:<span class="hljs-number">32</span>].decode()<br>        _<span class="hljs-built_in">hash</span> = proof[<span class="hljs-number">37</span>:<span class="hljs-number">101</span>].decode()<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> product(table, repeat=<span class="hljs-number">4</span>):<br>            head = <span class="hljs-string">&#x27;&#x27;</span>.join(i)<br>            t = hashlib.sha256((head + tail).encode()).hexdigest()<br>            <span class="hljs-keyword">if</span> t == _<span class="hljs-built_in">hash</span>:<br>                self.sh.sendline(head.encode())<br>                <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">interaction</span>(<span class="hljs-params">self</span>):<br>        flag = <span class="hljs-string">&#x27;&#x27;</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">34</span>):<br>            self.sh.sendline(<span class="hljs-built_in">str</span>(i).encode()) <span class="hljs-comment">#注意int不能直接encode()</span><br>            flag += self.sh.recvline().decode()[-<span class="hljs-number">2</span>]<br>        <span class="hljs-built_in">print</span>(flag)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>(<span class="hljs-params">self</span>):<br>        self.proof_of_work()<br>        self.interaction()<br>        self.sh.close()<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    solution = Solve()<br>    solution.solve()<br></code></pre></td></tr></table></figure><p>然后就可以进行一个小交互了</p><h5 id="输出："><a href="#输出：" class="headerlink" title="输出："></a>输出：</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">[+] Opening connection to <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> on port <span class="hljs-number">12321</span>: Done <br> nulctf&#123;DO_YOU_KNOW_ALAN-BECKER?&#125;<br>[*] Closed connection to <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> port <span class="hljs-number">12321</span><br></code></pre></td></tr></table></figure><h3 id="nc连接效果："><a href="#nc连接效果：" class="headerlink" title="nc连接效果："></a>nc连接效果：</h3><figure class="highlight console"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">nc 127.0.0.1 12</span><br>321<br>[+] sha256(XXXX+UJvk8n7uX5zAj073) == 0c8e4e2a5771107eedba5725c742f0ca5f1d3f05a67949d68c76ed05dfce14cc<br>[+] Plz tell me XXXX: yyj1  <br>[+]<br>[-] 1<br>[+] n<br>[-] 6<br>[+] f<br>[-] 8<br>[+] D<br>[-] 9<br>[+] O<br>[-] 4<br>[+] c<br>[-] 5<br>[+] t<br>[-] 7<br>[+] &#123;<br>[-] 9<br>[+] O<br>[-] 4<br>[+] c<br>[-] y<br>[!] Invalid Member!<br>[-] 22<br>[+] A<br>[-] 99<br>[!] Invalid Member!<br>[-] -3<br>[!] Invalid Member!<br>[-] 32<br>[+] &#125;<br>[-] ^C<br></code></pre></td></tr></table></figure><p>代码参考来自<a href="https://harry0597.com/2022/06/04/%E5%AF%86%E7%A0%81%E5%87%BA%E9%A2%98%E6%8C%87%E5%8C%97/">密码出题指北 | Harry’s Blog (harry0597.com)</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>青少年CTF擂台挑战赛2024Round1</title>
    <link href="/2024/03/21/%E9%9D%92%E5%B0%91%E5%B9%B4CTF%E6%93%82%E5%8F%B0%E6%8C%91%E6%88%98%E8%B5%9B2024Round1/"/>
    <url>/2024/03/21/%E9%9D%92%E5%B0%91%E5%B9%B4CTF%E6%93%82%E5%8F%B0%E6%8C%91%E6%88%98%E8%B5%9B2024Round1/</url>
    
    <content type="html"><![CDATA[<h3 id="解个方程"><a href="#解个方程" class="headerlink" title="解个方程"></a>解个方程</h3><h4 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h4><p>一个动态flag<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">p</span> = <span class="hljs-number">151655885656450332076952504214322757273</span>  <br><span class="hljs-attr">q</span> = <span class="hljs-number">148531443385360803011533167272599291111</span>  <br><span class="hljs-attr">e</span> = <span class="hljs-number">65537</span><br><span class="hljs-attr">d</span> = ?<br></code></pre></td></tr></table></figure></p><h4 id="解答"><a href="#解答" class="headerlink" title="解答"></a>解答</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2  <br>p = <span class="hljs-number">151655885656450332076952504214322757273</span>  <br>q = <span class="hljs-number">148531443385360803011533167272599291111</span>  <br>e = <span class="hljs-number">65537</span>  <br>n = q*p  <br>phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)  <br>d = gmpy2.invert(e,phi)  <br><span class="hljs-built_in">print</span>(d)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">1288909371486973234158599185728560686247715008971192466783006826206253573473</span><br></code></pre></td></tr></table></figure><h3 id="ez-log"><a href="#ez-log" class="headerlink" title="ez_log"></a>ez_log</h3><h4 id="题目："><a href="#题目：" class="headerlink" title="题目："></a>题目：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>flag=<span class="hljs-string">b&#x27;key&#123;xxxxxxx&#125;&#x27;</span><br>m=bytes_to_long(flag)<br>p=<span class="hljs-number">3006156660704242356836102321001016782090189571028526298055526061772989406357037170723984497344618257575827271367883545096587962708266010793826346841303043716776726799898939374985320242033037</span><br>g=<span class="hljs-number">3</span><br>c=<span class="hljs-built_in">pow</span>(g,m,p)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c=&#x27;</span>,c)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">c=2992612627750886887770858313476352707594644300807594304705044416699839774471838751545708692735859654685857490788683751410989270851331507477475091396007893070015119892479188689286417701654825</span><br></code></pre></td></tr></table></figure><h4 id="解答："><a href="#解答：" class="headerlink" title="解答："></a>解答：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage</span><br>m = discrete_log(mod(c,p),mod(g,p))<br><span class="hljs-comment">#或者可以省略，直接写</span><br>m = discrete_log(c,mod(g,p))<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>long_to_bytes(<span class="hljs-number">129834262657483951719921277</span>)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">b&#x27;key&#123;X8fba6&#125;&#x27;</span><br></code></pre></td></tr></table></figure><p>输入容器得到flag</p><h3 id="ezrsa"><a href="#ezrsa" class="headerlink" title="ezrsa"></a>ezrsa</h3><h4 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>flag = <span class="hljs-string">b&#x27;qsnctf&#123;xxx-xxxx-xxxx-xxxx-xxxxxxxxx&#125;&#x27;</span><br>m = bytes_to_long(flag)<br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>r = getPrime(<span class="hljs-number">512</span>)<br>n = p * q * r<br>leak = p * q<br>e = <span class="hljs-number">0x10001</span><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;leak = <span class="hljs-subst">&#123;leak&#125;</span>&#x27;</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string"># c = 173595148273920891298949441727054328036798235134009407863895058729356993814829340513336567479145746034781201823694596731886346933549577879568197521436900228804336056005940048086898794965549472641334237175801757569154295743915744875800647234151498117718087319013271748204766997008772782882813572814296213516343420236873651060868227487925491016675461540894535563805130406391144077296854410932791530755245514034242725719196949258860635915202993968073392778882692892</span><br><span class="hljs-string"># n = 1396260492498511956349135417172451037537784979103780135274615061278987700332528182553755818089525730969834188061440258058608031560916760566772742776224528590152873339613356858551518007022519033843622680128062108378429621960808412913676262141139805667510615660359775475558729686515755127570976326233255349428771437052206564497930971797497510539724340471032433502724390526210100979700467607197448780324427953582222885828678441579349835574787605145514115368144031247</span><br><span class="hljs-string"># leak = 152254254502019783796170793516692965417859793325424454902983763285830332059600151137162944897787532369961875766745853731769162511788354655291037150251085942093411304833287510644995339391240164033052417935316876168953838783742499485868268986832640692657031861629721225482114382472324320636566226653243762620647</span><br></code></pre></td></tr></table></figure><h4 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h4><script type="math/tex; mode=display">\begin{align}&c\equiv m^{e}\pmod{n} \\&c\equiv m^{e}\pmod{p*q*r}\\&c\equiv m^{e}\pmod{r} \end{align}</script><h4 id="解答-1"><a href="#解答-1" class="headerlink" title="解答"></a>解答</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes  <br><span class="hljs-keyword">import</span> gmpy2  <br>c = <br>n =  <br>leak =  <br>e = <span class="hljs-number">0x10001</span>  <br>  <br>r = n//leak  <br>phi = r-<span class="hljs-number">1</span>  <br>d = gmpy2.invert(e, phi)  <br>m = <span class="hljs-built_in">pow</span>(c, d, r)  <br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">qsnctf&#123;12ff81e0-7646-4a96-a7eb-6a509ec01c9e&#125;</span><br></code></pre></td></tr></table></figure><h3 id="factor1"><a href="#factor1" class="headerlink" title="factor1"></a>factor1</h3><h4 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>d = getPrime(<span class="hljs-number">256</span>)<br>e = gmpy2.invert(d, (p**<span class="hljs-number">2</span> - <span class="hljs-number">1</span>) * (q**<span class="hljs-number">2</span> - <span class="hljs-number">1</span>))<br>flag = <span class="hljs-string">&quot;qsnctf&#123;&quot;</span> + hashlib.md5(<span class="hljs-built_in">str</span>(p + q).encode()).hexdigest() + <span class="hljs-string">&quot;&#125;&quot;</span><br><span class="hljs-built_in">print</span>(e)<br><span class="hljs-built_in">print</span>(p * q)<br><span class="hljs-comment">#4602579741478096718172697218991734057017874575484294836043557658035277770732473025335441717904100009903832353915404911860888652406859201203199117870443451616457858224082143505393843596092945634675849883286107358454466242110831071552006337406116884147391687266536283395576632885877802269157970812862013700574069981471342712011889330292259696760297157958521276388120468220050600419562910879539594831789625596079773163447643235584124521162320450208920533174722239029506505492660271016917768383199286913178821124229554263149007237679675898370759082438533535303763664408320263258144488534391712835778283152436277295861859</span><br><span class="hljs-comment">#78665180675705390001452176028555030916759695827388719494705803822699938653475348982551790040292552032924503104351703419136483078949363470430486531014134503794074329285351511023863461560882297331218446027873891885693166833003633460113924956936552466354566559741886902240131031116897293107970411780310764816053</span><br></code></pre></td></tr></table></figure><h4 id="解答-2"><a href="#解答-2" class="headerlink" title="解答:"></a>解答:</h4><p> 这道是参考+复现</p><script type="math/tex; mode=display">\begin{align}(p^2-1)(q^2-1)&=(pq)^2-(p^2+q^2)+1\\ed&\equiv1\mod (p^2-1)(q^2-1)\\ed-k*(p^2-1)(q^2-1)&=1\\(p^2-1)(q^2-1)&>2d\\\left|\frac{e}{(p^2-1)(q^2-1)}-\frac{k}{d}\right|&=\frac{1}{(p^2-1)(q^2-1)*d}<\frac{1}{2d^2}\end{align}</script><p>用<code>wiener</code>恢复出<code>k,d</code>，$(p^2-1)(q^2-1)$与$p^2q^2$相差$p^2+q^2-1$，相应数量级位<code>2046</code>和<code>1025</code>，故可忽略不计，将其用$p^2q^2$进行连分数渐进</p><script type="math/tex; mode=display">\begin{align}p^2+q^2&=(pq)^2-(p^2-1)(q^2-1)+1\\p+q&=\sqrt{p^2+q^2+2pq}\\p-q&=\sqrt{p^2+q^2-2pq}\end{align}</script><p>在<code>sage</code>中有<code>two_squares</code>函数，可以暴力算$p^2+q^2$的形式，但本题数据有点大，没有跑出来。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#sage </span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br> <br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> iroot<br> <br><span class="hljs-keyword">import</span> hashlib<br> <br>e = <span class="hljs-number">4602579741478096718172697218991734057017874575484294836043557658035277770732473025335441717904100009903832353915404911860888652406859201203199117870443451616457858224082143505393843596092945634675849883286107358454466242110831071552006337406116884147391687266536283395576632885877802269157970812862013700574069981471342712011889330292259696760297157958521276388120468220050600419562910879539594831789625596079773163447643235584124521162320450208920533174722239029506505492660271016917768383199286913178821124229554263149007237679675898370759082438533535303763664408320263258144488534391712835778283152436277295861859</span><br> <br>pq = <span class="hljs-number">78665180675705390001452176028555030916759695827388719494705803822699938653475348982551790040292552032924503104351703419136483078949363470430486531014134503794074329285351511023863461560882297331218446027873891885693166833003633460113924956936552466354566559741886902240131031116897293107970411780310764816053</span><br> <br>pqx = pq ^ <span class="hljs-number">2</span><br> <br>fra = (e/pqx).continued_fraction()<br> <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(fra)):<br> <br>    k, d = fra.numerator(i), fra.denominator(i)<br> <br>    <span class="hljs-keyword">if</span> (e*d - <span class="hljs-number">1</span>) % k == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> d &gt; <span class="hljs-number">2</span>^<span class="hljs-number">250</span>:<br> <br>        <span class="hljs-built_in">print</span>(k, d)<br> <br>        <span class="hljs-keyword">break</span><br> <br>temp = (e*d - <span class="hljs-number">1</span>) // k<br> <br>pq_square = pqx - temp + <span class="hljs-number">1</span><br> <br>p_q = iroot(pq_square - <span class="hljs-number">2</span>*pq, <span class="hljs-number">2</span>)[<span class="hljs-number">0</span>]<br> <br>p__q = iroot(pq_square + <span class="hljs-number">2</span>*pq, <span class="hljs-number">2</span>)[<span class="hljs-number">0</span>]<br> <br>q = (p_q + p__q) // <span class="hljs-number">2</span><br> <br>p = pq // q<br> <br>flag = <span class="hljs-string">&quot;qsnctf&#123;&quot;</span> + hashlib.md5(<span class="hljs-built_in">str</span>(p + q).encode()).hexdigest() + <span class="hljs-string">&quot;&#125;&quot;</span><br> <br><span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">qsnctf&#123;8072e8b2982bc729cc74ef58f1abc862&#125;</span><br></code></pre></td></tr></table></figure><h3 id="四重加密"><a href="#四重加密" class="headerlink" title="四重加密"></a>四重加密</h3><p><strong>复现‘是在网上下载了一 随波逐流 CTF编码工具</strong><br>压缩包在WinRAR打开查看<br>![[<a href="https://s2.loli.net/2024/03/21/RQ7tdHChoEWvTzY.png">https://s2.loli.net/2024/03/21/RQ7tdHChoEWvTzY.png</a>]]<br>base32解码得到：qsnctf<br>解压得txt：<br>&#122;&#99;&#121;&#101;&#123;&#109;&#120;&#109;&#101;&#109;&#116;&#120;&#114;&#122;&#116;&#95;&#108;&#122;&#98;&#104;&#97;&#95;&#107;&#119;&#109;&#113;&#122;&#101;&#99;&#125;&#124;&#107;&#101;&#121;&#61;&#104;&#101;&#108;&#108;&#111;<br>是unicoed，转ASCII：zcye{mxmemtxrzt_lzbha_kwmqzec}|key=hello<br>![[<a href="https://s2.loli.net/2024/03/21/4yYPsTfRJHSmAjU.png">https://s2.loli.net/2024/03/21/4yYPsTfRJHSmAjU.png</a>]]<br>还没有得到flag，再解：<br>![[<a href="https://s2.loli.net/2024/03/21/UKCbT8hqHviW5uV.png">https://s2.loli.net/2024/03/21/UKCbT8hqHviW5uV.png</a>]]</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>2024第一届VCTF纳新赛crypto方向wp</title>
    <link href="/2024/03/18/2024%E7%AC%AC%E4%B8%80%E5%B1%8AVCTF%E7%BA%B3%E6%96%B0%E8%B5%9Bcrypto%E6%96%B9%E5%90%91wp/"/>
    <url>/2024/03/18/2024%E7%AC%AC%E4%B8%80%E5%B1%8AVCTF%E7%BA%B3%E6%96%B0%E8%B5%9Bcrypto%E6%96%B9%E5%90%91wp/</url>
    
    <content type="html"><![CDATA[<h3 id="狂飙"><a href="#狂飙" class="headerlink" title="狂飙"></a>狂飙</h3><h4 id="题目："><a href="#题目：" class="headerlink" title="题目："></a>题目：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><br>m = <span class="hljs-number">88007513702424243702066490849596817304827839547007641526433597788800212065249</span><br>key = os.urandom(<span class="hljs-number">24</span>)<br>key = bytes_to_long(key)<br>n=m % key<br>flag += (<span class="hljs-number">16</span> - <span class="hljs-built_in">len</span>(flag) % <span class="hljs-number">16</span>) * <span class="hljs-string">b&#x27;\x00&#x27;</span><br>iv = os.urandom(<span class="hljs-number">16</span>)<br>aes = AES.new(key,AES.MODE_CBC,iv)<br>enc_flag = aes.encrypt(flag)<br><br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-built_in">print</span>(enc_flag)<br><span class="hljs-built_in">print</span>(iv)<br><br><span class="hljs-comment">#103560843006078708944833658339172896192389513625588</span><br><span class="hljs-comment">#b&#x27;\xfc\x87\xcb\x8e\x9d\x1a\x17\x86\xd9~\x16)\xbfU\x98D\xfe\x8f\xde\x9c\xb0\xd1\x9e\xe7\xa7\xefiY\x95C\x14\x13C@j1\x9d\x08\xd9\xe7W&gt;F2\x96cm\xeb&#x27;</span><br><span class="hljs-comment">#b&#x27;UN\x1d\xe2r&lt;\x1db\x00\xdb\x9a\x84\x1e\x82\xf0\x86&#x27;</span><br></code></pre></td></tr></table></figure><h4 id="解答："><a href="#解答：" class="headerlink" title="解答："></a>解答：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><br>m = <span class="hljs-number">88007513702424243702066490849596817304827839547007641526433597788800212065249</span><br>n = <span class="hljs-number">103560843006078708944833658339172896192389513625588</span><br>enc_flag = <span class="hljs-string">b&#x27;\xfc\x87\xcb\x8e\x9d\x1a\x17\x86\xd9~\x16)\xbfU\x98D\xfe\x8f\xde\x9c\xb0\xd1\x9e\xe7\xa7\xefiY\x95C\x14\x13C@j1\x9d\x08\xd9\xe7W&gt;F2\x96cm\xeb&#x27;</span><br>iv = <span class="hljs-string">b&#x27;UN\x1d\xe2r&lt;\x1db\x00\xdb\x9a\x84\x1e\x82\xf0\x86&#x27;</span><br><br><span class="hljs-comment">#factor(m-n) = 3 * 37 * 439 * 3939851 * 265898280367 * 5036645362649 * 342291058100503482469327892079792475478873</span><br>key = <span class="hljs-number">342291058100503482469327892079792475478873</span> * <span class="hljs-number">37</span> * <span class="hljs-number">439</span> * <span class="hljs-number">265898280367</span><br><br>k = long_to_bytes(key)<br><br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(long_to_bytes(key)) == <span class="hljs-number">24</span>:<br>    aes = AES.new(k,AES.MODE_CBC,iv)<br>    flag = aes.decrypt(enc_flag)<br>    <span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h3 id="RRSA"><a href="#RRSA" class="headerlink" title="RRSA"></a>RRSA</h3><h4 id="题目：-1"><a href="#题目：-1" class="headerlink" title="题目："></a>题目：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">genprime</span>():<br>o = getPrime(<span class="hljs-number">300</span>)<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>r = random.randint(<span class="hljs-number">2</span>**<span class="hljs-number">211</span>,<span class="hljs-number">2</span>**<span class="hljs-number">212</span>)<br><span class="hljs-keyword">if</span> isPrime(o*r+<span class="hljs-number">1</span>):<br><span class="hljs-keyword">return</span> o,o*r+<span class="hljs-number">1</span><br>o1,p = genprime()<br>o2,q = genprime()<br>n=p*q<br>g = random.randint(<span class="hljs-number">2</span>,n)<br>order = o1*o2<br><br>a = <span class="hljs-built_in">pow</span>(g, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)//order, n)<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">pow</span>(a,order,n)==<span class="hljs-number">1</span><br><br>m = bytes_to_long(flag)<br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n=<span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c=<span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;a=<span class="hljs-subst">&#123;a&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;o=<span class="hljs-subst">&#123;order&#125;</span>&#x27;</span>)<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n=44435425447782114838897637647733409614831121089064725526413247701631122523646623518523253532066782191116739274354991533158902831935676078270115998050827358178237970133151467497051097694866238654012042884894924846645692294679774577780414805605811029994570132760841672754334836945991390844881416693502552870759</span><br><span class="hljs-string">c=41355409695119524180275572228024314281790321005050664347253778436753663918879919757571129194249071204946415158483084730406579433518426895158142068246063333111438863836668823874266012696265984976829088976346775293102571794377818611709336242495598331872036489022428750111592728015245733975923531682859930386731</span><br><span class="hljs-string">a=39844923600973712577104437232871220768052114284995840460375902596405104689968610170336151307934820030811039502338683925817667771016288030594299464019664781911131177394369348831163266849069740191783143327911986419528382896919157135487360024877230254274474109707112110411601273850406237677432935818199348150470</span><br><span class="hljs-string">o=1745108106200960949680880500144134006212310627077303652648249235148621661187609612344828833696608872318217367008018829485062303972702933973340909520462917612611270028511222134076453</span><br></code></pre></td></tr></table></figure><h4 id="解析："><a href="#解析：" class="headerlink" title="解析："></a>解析：</h4><p>由于$n=qp=(o_1<em>r_1+1)(o_2</em>r_2+1)$<br>所以用n整除o就可以得到$r_1*r_2$</p><h4 id="解答：-1"><a href="#解答：-1" class="headerlink" title="解答："></a>解答：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br>n=<span class="hljs-number">44435425447782114838897637647733409614831121089064725526413247701631122523646623518523253532066782191116739274354991533158902831935676078270115998050827358178237970133151467497051097694866238654012042884894924846645692294679774577780414805605811029994570132760841672754334836945991390844881416693502552870759</span><br>c=<span class="hljs-number">41355409695119524180275572228024314281790321005050664347253778436753663918879919757571129194249071204946415158483084730406579433518426895158142068246063333111438863836668823874266012696265984976829088976346775293102571794377818611709336242495598331872036489022428750111592728015245733975923531682859930386731</span><br>a=<span class="hljs-number">39844923600973712577104437232871220768052114284995840460375902596405104689968610170336151307934820030811039502338683925817667771016288030594299464019664781911131177394369348831163266849069740191783143327911986419528382896919157135487360024877230254274474109707112110411601273850406237677432935818199348150470</span><br>o=<span class="hljs-number">1745108106200960949680880500144134006212310627077303652648249235148621661187609612344828833696608872318217367008018829485062303972702933973340909520462917612611270028511222134076453</span><br>e = <span class="hljs-number">65537</span><br><br>r = n//o<br>phi = o*r<br>d = gmpy2.invert(e,phi)<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">pow</span>(c,d,n)))<br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">b&#x27;flag&#123;0228FC7F-C865-BD0F-F124-9F9860B3542B&#125;&#x27;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>极客大挑战2023</title>
    <link href="/2023/12/22/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982023/"/>
    <url>/2023/12/22/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982023/</url>
    
    <content type="html"><![CDATA[<p>记人生中第一次打的CTF比赛</p><h1 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h1><h2 id="SignIn"><a href="#SignIn" class="headerlink" title="SignIn"></a>SignIn</h2><p>  明文：5359437b48656c6c6f5f576f726c645f43727970746f5f6269626f6269626f7d<br>  用base16解码得密文：SYC{Hello_World_Crypto_bibobibo}<br>  得到flag</p><h2 id="proof-of-work"><a href="#proof-of-work" class="headerlink" title="proof_of_work"></a>proof_of_work</h2><p>  一个sha256<br><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs scss">import hashlib<br><br>for i1 in <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>,<span class="hljs-number">127</span>):  <br>    for i2 in <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>, <span class="hljs-number">127</span>):  <br>        for i3 in <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>, <span class="hljs-number">127</span>):  <br>            for i4 in <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>, <span class="hljs-number">127</span>):  <br>                m = hashlib.<span class="hljs-built_in">sha256</span>()  <br>                m.<span class="hljs-built_in">update</span>(<span class="hljs-built_in">str</span>(<span class="hljs-built_in">chr</span>(i1)+<span class="hljs-built_in">chr</span>(i2)+<span class="hljs-built_in">chr</span>(i3)+<span class="hljs-built_in">chr</span>(i4)+<span class="hljs-string">&#x27;qzxf4BpAvFfWGED3&#x27;</span>).<span class="hljs-built_in">encode</span>(<span class="hljs-string">&#x27;utf-8&#x27;</span>))  <br>                des = m.<span class="hljs-built_in">hexdigest</span>()  <br>                if des == <span class="hljs-string">&#x27;5d60736ba4dac09953d7187939d5861ed2d46faf874c5142157aae8430dead84&#x27;</span>:  <br>                    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(i1)+<span class="hljs-built_in">chr</span>(i2)+<span class="hljs-built_in">chr</span>(i3)+<span class="hljs-built_in">chr</span>(i4)+<span class="hljs-string">&#x27;qzxf4BpAvFfWGED3&#x27;</span>)<br></code></pre></td></tr></table></figure><br><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-meta"># 输出</span><br><span class="hljs-meta"># S2iuqzxf4BpAvFfWGED3</span><br></code></pre></td></tr></table></figure><br>  输入前四位，得到flag：SYC{st3p_1nt0_1nter4ctive_Crypt0graphy}</p><h2 id="SimpleRSA"><a href="#SimpleRSA" class="headerlink" title="SimpleRSA"></a>SimpleRSA</h2><h4 id="解答："><a href="#解答：" class="headerlink" title="解答："></a>解答：</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs makefile">import gmpy2  <br>from Crypto.Util.number import *<br><br>e =65537  <br>p = 24724324630507415330944861660078769085865178656494256140070836181271808964994457686409910764936630391300708451701526900994412268365698217113884698394658886249353179639767806926527103624836198494439742123128823109527320850165486500517304731554371680236789357527395416607541627295126502440202040826686102479225702795427693781581584928770373613126894936500089282093366117940069743670997994742595407158340397268147325612840109162997306902492023078425623839297511182053658542877738887677835528624045235391227122453939459585542485427063193993069301141720316104612551340923656979591045138487394366671477460626997125944456537  <br>c = 510345661718450375632304764819724223824018609359964259503762283253350010161515190912152623604019093266967095847334388281390406831587663253164256543905694021952211220652820225527413861208452760215767828927039893435528572148282529198773772864255061213208279999011194952146362748485103032149806538140693537361755210176698895104708379400806511907719904867068865970241208806615061055047254026118016836750283966478103987375361826198930529462261013324904522014804502582865716441828895047550041401172127129749969507853355531197814919603963664646220505672302543085959372679395717892060245461464861507164276442140407308832537707450729432224150754603518526288767105682399190438680085925078051459448618725871249563011864525585870188123725554411655044152994826056900502298772802133526591794328224932405680583757307064395792317383571866619582974377344736930271554160701478385763426091091686496788999588340419226785217028504684542197970387916262126278955278523452903043316452825738030645100271595942652498852506660789605846309602343932245435421425673058238785509280366229754404949219663043627431437755087855502139890639468481922788973821783957766433857773771229298328019250652625289700950165414584983487319078090573179470893450632419467111117341472  <br>q = 3  <br>  <br><span class="hljs-comment"># n = p*q  </span><br><span class="hljs-comment"># phi = (p-1)*(q-1)  </span><br>phi = p-1  <br>d = gmpy2.invert(e,phi)  <br>m = pow(c,d,p)  <br>flag = long_to_bytes(m)  <br>  <br>assert len(flag) == 35  <br>print(flag)<br></code></pre></td></tr></table></figure><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><span class="hljs-meta"># 运行结果</span><br><span class="hljs-meta"># b<span class="hljs-string">&#x27;SYC&#123;Just_a_s1mple_modular_equation&#125;&#x27;</span></span><br></code></pre></td></tr></table></figure><p>  得到flag</p><h2 id="OTPTwice"><a href="#OTPTwice" class="headerlink" title="OTPTwice"></a>OTPTwice</h2><h4 id="解答：-1"><a href="#解答：-1" class="headerlink" title="解答："></a>解答：</h4><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-keyword">c</span><span class="hljs-number">1</span> <span class="hljs-operator">=</span> bytearray(b&#x27;\xdbi\xab\<span class="hljs-keyword">x</span><span class="hljs-number">8</span>d\xfb<span class="hljs-number">0</span>\xd<span class="hljs-number">3</span>\xfe!\xf<span class="hljs-number">8</span>Xpy\<span class="hljs-keyword">x</span><span class="hljs-number">80</span>w\<span class="hljs-keyword">x</span><span class="hljs-number">8</span><span class="hljs-keyword">c</span>\<span class="hljs-keyword">x</span><span class="hljs-number">87</span>\xb<span class="hljs-number">9</span>&#x27;)  <br><span class="hljs-keyword">c</span><span class="hljs-number">2</span> <span class="hljs-operator">=</span> bytearray(b&#x27;o\xb<span class="hljs-number">0</span>%\xfb\xdb\<span class="hljs-keyword">x</span><span class="hljs-number">0</span>e\r\<span class="hljs-keyword">x</span><span class="hljs-number">04</span>\xde\xd<span class="hljs-number">1</span>\<span class="hljs-keyword">x</span><span class="hljs-number">9</span>a\<span class="hljs-keyword">x</span><span class="hljs-number">08</span>w\xda<span class="hljs-number">4</span>\<span class="hljs-keyword">x</span><span class="hljs-number">0</span>f\<span class="hljs-keyword">x</span><span class="hljs-number">0</span>cR&#x27;)  <br><span class="hljs-keyword">c</span><span class="hljs-number">3</span> <span class="hljs-operator">=</span> bytearray(b&#x27;\xe<span class="hljs-number">7</span>\<span class="hljs-keyword">x</span><span class="hljs-number">80</span>\xcd\ria\xb<span class="hljs-number">2</span>\xca\<span class="hljs-keyword">x</span><span class="hljs-number">89</span>\<span class="hljs-keyword">x</span><span class="hljs-number">1</span>a\<span class="hljs-keyword">x</span><span class="hljs-number">9</span>d<span class="hljs-comment">;|#3\xf7\xbb\x96&#x27;)  </span><br>  <br>k<span class="hljs-number">2</span> <span class="hljs-operator">=</span> bytearray(<span class="hljs-keyword">x</span> ^ y for <span class="hljs-keyword">x</span><span class="hljs-punctuation">,</span>y in zip(<span class="hljs-keyword">c</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-keyword">c</span><span class="hljs-number">2</span>))  <br>k<span class="hljs-number">1</span> <span class="hljs-operator">=</span> bytearray(<span class="hljs-keyword">x</span> ^ y for <span class="hljs-keyword">x</span><span class="hljs-punctuation">,</span>y in zip(<span class="hljs-keyword">c</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span><span class="hljs-keyword">c</span><span class="hljs-number">3</span>))  <br>m <span class="hljs-operator">=</span> bytearray(<span class="hljs-keyword">x</span> ^ y for <span class="hljs-keyword">x</span><span class="hljs-punctuation">,</span>y in zip(<span class="hljs-keyword">c</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span>k<span class="hljs-number">2</span>))  <br>  <br>print(m)<br></code></pre></td></tr></table></figure><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><span class="hljs-meta"># 输出</span><br><span class="hljs-meta"># bytearray(b<span class="hljs-string">&#x27;SYC&#123;I_l0v3_Crypt0&#125;&#x27;</span>)</span><br></code></pre></td></tr></table></figure><h2 id="OldAlgorithm"><a href="#OldAlgorithm" class="headerlink" title="OldAlgorithm"></a>OldAlgorithm</h2><p>  该题是中国剩余定理情况</p><h4 id="解答：-2"><a href="#解答：-2" class="headerlink" title="解答："></a>解答：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> math  <br>  <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Get_Mi</span>(<span class="hljs-params">m_list, m</span>):  <br>    M_list = []  <br>    <span class="hljs-keyword">for</span> mi <span class="hljs-keyword">in</span> m_list:  <br>        M_list.append(m // mi)  <br>    <span class="hljs-keyword">return</span> M_list  <br>  <br>  <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Get_resMi</span>(<span class="hljs-params">M_list, m_list</span>):  <br>    resM_list = []  <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(M_list)):  <br>        resM_list.append(Get_ni(M_list[i], m_list[i])[<span class="hljs-number">0</span>])  <br>    <span class="hljs-keyword">return</span> resM_list  <br>  <br>  <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Get_ni</span>(<span class="hljs-params">a, b</span>):  <br>    <span class="hljs-keyword">if</span> b == <span class="hljs-number">0</span>:  <br>        x = <span class="hljs-number">1</span>  <br>        y = <span class="hljs-number">0</span>  <br>        q = a  <br>        <span class="hljs-keyword">return</span> x, y, q  <br>    ret = Get_ni(b, a % b)  <br>    x = ret[<span class="hljs-number">0</span>]  <br>    y = ret[<span class="hljs-number">1</span>]  <br>    q = ret[<span class="hljs-number">2</span>]  <br>    temp = x  <br>    x = y  <br>    y = temp - a // b * y  <br>    <span class="hljs-keyword">return</span> x, y, q  <br>  <br>  <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">result</span>(<span class="hljs-params">a_list, m_list</span>):  <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(m_list)):  <br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i + <span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(m_list)):  <br>            <span class="hljs-keyword">if</span> <span class="hljs-number">1</span> != math.gcd(m_list[i], m_list[j]):  <br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;不能直接利用中国剩余定理&quot;</span>)  <br>                <span class="hljs-keyword">return</span>  <br>    m = <span class="hljs-number">1</span>  <br>    <span class="hljs-keyword">for</span> mi <span class="hljs-keyword">in</span> m_list:  <br>        m *= mi  <br>    Mi_list = Get_Mi(m_list, m)  <br>    Mi_inverse = Get_resMi(Mi_list, m_list)  <br>    x = <span class="hljs-number">0</span>  <br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a_list)):  <br>        x += Mi_list[i] * Mi_inverse[i] * a_list[i]  <br>        x %= m  <br>    <span class="hljs-keyword">return</span> x  <br>  <br>p= [<span class="hljs-number">58657</span>, <span class="hljs-number">47093</span>, <span class="hljs-number">47963</span>, <span class="hljs-number">41213</span>, <span class="hljs-number">57653</span>, <span class="hljs-number">56923</span>, <span class="hljs-number">41809</span>, <span class="hljs-number">49639</span>, <span class="hljs-number">44417</span>, <span class="hljs-number">38639</span>, <span class="hljs-number">39857</span>, <span class="hljs-number">53609</span>, <span class="hljs-number">55621</span>, <span class="hljs-number">41729</span>, <span class="hljs-number">60497</span>, <span class="hljs-number">44647</span>, <span class="hljs-number">39703</span>, <span class="hljs-number">55117</span>, <span class="hljs-number">44111</span>, <span class="hljs-number">57131</span>, <span class="hljs-number">37747</span>, <span class="hljs-number">63419</span>, <span class="hljs-number">63703</span>, <span class="hljs-number">64007</span>, <span class="hljs-number">46349</span>, <span class="hljs-number">39241</span>, <span class="hljs-number">39313</span>, <span class="hljs-number">44909</span>, <span class="hljs-number">40763</span>, <span class="hljs-number">46727</span>, <span class="hljs-number">34057</span>, <span class="hljs-number">56333</span>]  <br>c= [<span class="hljs-number">36086</span>, <span class="hljs-number">4005</span>, <span class="hljs-number">3350</span>, <span class="hljs-number">23179</span>, <span class="hljs-number">34246</span>, <span class="hljs-number">5145</span>, <span class="hljs-number">32490</span>, <span class="hljs-number">16348</span>, <span class="hljs-number">13001</span>, <span class="hljs-number">13628</span>, <span class="hljs-number">7742</span>, <span class="hljs-number">46317</span>, <span class="hljs-number">50824</span>, <span class="hljs-number">23718</span>, <span class="hljs-number">32995</span>, <span class="hljs-number">7640</span>, <span class="hljs-number">10590</span>, <span class="hljs-number">46897</span>, <span class="hljs-number">39245</span>, <span class="hljs-number">16633</span>, <span class="hljs-number">31488</span>, <span class="hljs-number">36547</span>, <span class="hljs-number">42136</span>, <span class="hljs-number">52782</span>, <span class="hljs-number">31929</span>, <span class="hljs-number">34747</span>, <span class="hljs-number">29026</span>, <span class="hljs-number">18748</span>, <span class="hljs-number">6634</span>, <span class="hljs-number">9700</span>, <span class="hljs-number">8126</span>, <span class="hljs-number">5197</span>]  <br><br><span class="hljs-built_in">print</span>(long_to_bytes(result(c,p)))<br></code></pre></td></tr></table></figure><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><span class="hljs-meta"># 输出</span><br><span class="hljs-meta"># b<span class="hljs-string">&#x27;SYC&#123;CRT_1s_s0_ju1cy!&#125;]mC\x9c\xf9C/\xfc\xb8t\x16&#x27;</span></span><br></code></pre></td></tr></table></figure><p>得到flag：SYC{CRT_1s_s0_ju1cy!}</p><h2 id="easy-classic"><a href="#easy-classic" class="headerlink" title="easy_classic"></a>easy_classic</h2><p>  第一层明文：udzeojxuwqcu<br>  凯撒加密，密钥Q，密文：enjoythegame</p><p>  第二层明文：ialhhooavtepcyr<br>  看起来很像打乱顺序的密文，重新排序后得到：ilovecryptohaha</p><p>  第三层明文：5a6H5a6Z5LiH5rOV55qE6YKj5Liq5rqQ5aS0<br>  base64解码，得到密文：宇宙万法的那个源头<br>    ps.必须是uft-8编码的汉字</p><p>  第四层明文：熊曰：呋食食食取噗山笨笨破嗄咯哈動嗡雜類嗒嘿啽沒歡破吖咬我啽寶盜噔咯沒<br>  熊曰加密，上网使用与相关加解密网站得到密文：never gonna give you up<br>    网站：<a href="http://hi.pcmoe.net/">与熊论道/熊曰加密 - PcMoe!</a></p><p>  第五层<br>  password: adltlfltqrcy<br>  key: 👝👘👠👩👞👘👤👜<br>    密钥为emoji加密，使用相关网站解密得到key：fairgame<br> Playfair解密，得到密文：genshinstart</p><p>  输入密文，解开最后的txt的锁，得到flag：SYC{classical_1s_fun}</p><h2 id="PolyRSA"><a href="#PolyRSA" class="headerlink" title="PolyRSA"></a>PolyRSA</h2><h4 id="解析："><a href="#解析：" class="headerlink" title="解析："></a>解析：</h4><p>$\because c1=(2p+3q)^{e1}$ mod n<br>$\therefore c1=((2p)^{e1}+(3q)^{e1})$ mod n<br>$\therefore c1^{e2}=((2p)^{K}+(3q)^{K})$ mod n<br>同理<br>$\because c2=(5p+7q)^{e1}$ mod n<br>$\therefore c2=((5p)^{e2}+(7q)^{e2})$ mod n<br>$\therefore c2^{e1}=((5p)^{K}+(7q)^{K})$ mod n</p><p>$\therefore c2^{e1}<em>3^{K}-c1^{e2}</em>7^{K}=p^{K}<em>(15^{K}-14^{K})=p^{K}$<br>  $c1^{e2}</em>5^{K}-c2^{e1}<em>2^{K}=q^{K}</em>(15^{K}-14^{K})=q^{K}$</p><p>$\therefore p=gcd(c2^{e1}<em>3^{K}-c1^{e2}</em>7^{K},n)$<br>  $q=gcd(c1^{e2}<em>5^{K}-c2^{e1}</em>2^{K},n)$</p><h4 id="解答：-3"><a href="#解答：-3" class="headerlink" title="解答："></a>解答：</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs makefile">from Crypto.Util.number import *<br>from gmpy2 import *<br>  <br>K = e1*e2  <br>w1 = (pow(c2, e1, n)*pow(3, K, n)) % n - (pow(c1, e2, n)*pow(7, K, n)) % n  <br>w2 = (pow(c1, e2, n)*pow(5, K, n)) % n - pow(c2, e1, n)*pow(2, K, n) % n  <br><span class="hljs-comment"># k1 = (c2**e1)*(3**K) - (c1**e2)*(7**K)  </span><br><span class="hljs-comment"># k2 = c1**e2*5**K - c2**e1*2**K  </span><br>  <br>p = gcd(w1, n)  <br>q = gcd(w2, n)  <br>phi = (p-1)*(q-1)  <br>d = inverse(e, phi)  <br>m = pow(c, d, n)  <br>print(long_to_bytes(m))<br><br>e = 65537  <br>e1 = 113717  <br>e2 = 80737  <br>c1 = 97528398828294138945371018405777243725957112272614466238005409057342884425132214761228537249844134865481148636534134025535106624840957740753950100180978607132333109806554009969378392835952544552269685553539656827070349532458156758965322477969141073720173165958341043159560928836304172136610929023123638981560836183245954461041167802574206323129671965436040047358250847178930436773249800969192016749684095882580749559014647942135761757750292281205876241566597813517452803933496218995755905344070203047797893640399372627351254542342772576533524820435965479881620338366838326652599102311019884528903481310690767832417584600334987458835108576322111553947045733143836419313427495888019352323209000292825566986863770366023326755116931788018138432898323148059980463407567431417724940484236335082696026821105627826117901730695680967455710434307270501190258033004471156993017301443803372029004817834317756597444195146024630164820841200575179112295902020141040090350486764038633257871003899386340004440642516190842086462237559715130631205046041819931656962904630367121414263911179041905140516402771368603623318492074423223885367923228718341206283572152570049573607906130786276734660847733952210105659707746969830132429975090175091281363770357  <br>c2 = 353128571201645377052005694809874806643786163076931670184196149901625274899734977100920488129375537186771931435883114557320913415191396857882995726660784707377672210953334914418470453787964899846194872721616628198368241044602144880543115393715025896206210152190007408112767478800650578941849344868081146624444817544806046188600685873402369145450593575618922226415069043442295774369567389939040265656574664538667552522329712111984168798829635080641332045614585247317991581514218486004191829362787750803153463482021229058714990823658655863245025037102127138472397462755776598314247771125981017814912049441827643898478473451005083533693951329544115861795587564408860828213753948427321483082041546722974666875065831843384005041800692983406353922680299538080900818930589336142421748023025830846906503542594380663429947801329079870530727382679634952272644949425079242992486832995962516376820051495641486546631849426876810933393153871774796182078367277299340503872124124714036499367887886486264658590613431293656417255355575602576047502506125375605713228912611320198066713358654181533335650785578352716562937038768171269136647529849805172492594142026261051266577821582011917001752590659862613307646536049830151262848916867223615064832279222  <br>c = 375617816311787295279632219241669262704366237192565344884527300748210925539528834207344757670998995567820735715933908541800125317082581328287816628816752542104514363629022246620070560324071543077301256917337165566677142545053272381990573611757629429857842709092285442319141751484248315990593292618113678910350875156232952525787082482638460259354559904243062546518553607882194808191571131590524874275187750985821420412987586148770397073003186510357920710387377990379862185266175190503647626248057084923516190642292152259727446111686043531725993433395002330208067534104745851308178560234372373476331387737629284961288204368572750848248186692623500372605736825205759172773503283282321274793846281079650686871355211691681512637459986684769598186821524093789286661348936784712071312135814683041839882338235290487868969391040389837253093468883093296547473466050960563347060307256735803099039921213839491129726807647623542881247210251994139130146519265086673883077644185971830004165931626986486648581644383717994174627681147696341976767364316172091139507445131410662391699728189797082878876950386933926807186382619331901457205957462337191923354433435013338037399565519987793880572723211669459895193009710035003369626116024630678400746946356  <br>n = 728002565949733279371529990942440022467681592757835980552797682116929657292509059813629423038094227544032071413317330087468458736175902373398210691802243764786251764982802000867437756347830992118278032311046807282193498960587170291978547754942295932606784354258945168927044376692224049202979158068158842475322825884209352566494900083765571037783472505580851500043517614314755340168507097558967372661966013776090657685241689631615245294004694287660685274079979318342939473469143729494106686592347327776078649315612768988028622890242005700892937828732613800620455225438339852445425046832904615827786856105112781009995862999853122308496903885748394541643702103368974605177097553007573113536089894913967154637055293769061726082740854619536748297829779639633209710676774371525146758917646731487495135734759201537358734170552231657257498090553682791418003138924472103077035355223367678622115314235119493397080290540006942708439607767313672671274857069053688258983103863067394473084183472609906612056828326916114024662795812611685559034285371151973580240723680736227737324052391721149957542711415812665358477474058103338801398214688403784213100455466705770532894531602252798634923125974783427678469124261634518543957766622712661056594132089  <br></code></pre></td></tr></table></figure><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><span class="hljs-meta"># 输出</span><br><span class="hljs-meta"># b<span class="hljs-string">&#x27;SYC&#123;poly_rsa_Just_need5_s1mple_gcd&#125;&#x27;</span></span><br></code></pre></td></tr></table></figure><h2 id="Fi1nd-th3-x’"><a href="#Fi1nd-th3-x’" class="headerlink" title="Fi1nd_th3_x’"></a>Fi1nd_th3_x’</h2><h4 id="解析：-1"><a href="#解析：-1" class="headerlink" title="解析："></a>解析：</h4><p>$\begin{cases}d \equiv dP \pmod{(q-1)<em>(r-1)} \\d \equiv dQ \pmod{(p-1)</em>(r-1)} \\d \equiv dR \pmod{(q-1)*(p-1)}\end{cases}$<br>中国剩余定理不互质</p><h4 id="解答：-4"><a href="#解答：-4" class="headerlink" title="解答："></a>解答：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2  <br><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> reduce  <br><br>p= <span class="hljs-number">13014610351521460822156239705430709078128228907778181478242620569429327799535062679140131416771915929573454741755415612880788196172134695027201422226050343</span>  <br>q= <span class="hljs-number">12772373441651008681294250861077909144300908972709561019514945881228862913558543752401850710742410181542277593157992764354184262443612041344749961361188667</span>  <br>r= <span class="hljs-number">12128188838358065666687296689425460086282352520167544115899775800918383085863282204525519245937988837403739683061218279585168168892037039644924073220678419</span>  <br>dP= <span class="hljs-number">116715737414908163105708802733763596338775040866822719131764691930369001776551671725363881836568414327815420649861207859100479999650414099346914809923964116101517432576562641857767638396325944526867458624878906968552835814078216316470330511385701105459053294771612727181278955929391807414985165924450505855941</span>  <br>dQ= <span class="hljs-number">44209639124029393930247375993629669338749966042856653556428540234515804939791650065905841618344611216577807325504984178760405516121845853248373571704473449826683120387747977520655432396578361308033763778324817416507993263234206797363191089863381905902638111246229641698709383653501799974217118168526572365797</span>  <br>dR= <span class="hljs-number">60735172709413093730902464873458655487237612458970735840670987186877666190533417038325630420791294593669609785154204677845781980482700493870590706892523016041087206844082222225206703139282240453277802870868459288354322845410191061009582969848870045522383447751431300627611762289800656277924903605593069856921</span>  <br>c= <span class="hljs-number">93063188325241977486352111369210103514669725591157371105152980481620575818945846725056329712195176948376321676112726029400835578531311113991944495646259750817465291340479809938094295621728828133981781064352306623727112813796314947081857025012662546178066873083689559924412320123824601550896063037191589471066773464829226873338699012924080583389032903142107586722373131642720522453842444615499672193051587154108368643495983197891525747653618742702589711752256009</span>  <br>  <br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;(p-1)*(r-1) =&#x27;</span>,(p-<span class="hljs-number">1</span>)*(r-<span class="hljs-number">1</span>))  <br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;(q-1)*(r-1) =&#x27;</span>,(q-<span class="hljs-number">1</span>)*(r-<span class="hljs-number">1</span>))  <br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;(p-1)*(q-1) =&#x27;</span>,(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))  <br><br>  <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exgcd</span>(<span class="hljs-params">a, b</span>):  <br>    <span class="hljs-keyword">if</span> b == <span class="hljs-number">0</span>: <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>, <span class="hljs-number">0</span>  <br>    x, y = exgcd(b, a % b)  <br>    <span class="hljs-keyword">return</span> y, x - a // b * y  <br>  <br>  <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">uni</span>(<span class="hljs-params">P, Q</span>):  <br>    r1, m1 = P  <br>    r2, m2 = Q  <br>  <br>    d = gmpy2.gcd(m1, m2)  <br>    <span class="hljs-keyword">assert</span> (r2 - r1) % d == <span class="hljs-number">0</span>  <br>  <br>    l1, l2 = exgcd(m1 // d, m2 // d)  <br>  <br>    <span class="hljs-keyword">return</span> (r1 + (r2 - r1) // d * l1 * m1) % gmpy2.lcm(m1, m2), gmpy2.lcm(m1, m2)  <br>  <br>  <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">CRT</span>(<span class="hljs-params">eq</span>):  <br>    <span class="hljs-keyword">return</span> reduce(uni, eq)  <br>  <br>  <br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:  <br>    n = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>())  <br>    eq = [<span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().strip().split()))[::-<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]  <br>    d = CRT(eq)[<span class="hljs-number">0</span>]<br>      <br>n = p*q*r  <br>m = <span class="hljs-built_in">pow</span>(c,d,n)  <br><br>flag = libnum.n2s(m)  <br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs gcode"><span class="hljs-attr"># 输出</span><br><span class="hljs-attr">(p-1</span>)*<span class="hljs-comment">(r-1)</span> = <span class="hljs-number">157843652000901922592922534078798438728561466809160280102796295598657892969643944706331069245997476544245343941352790420588475071314554864105017844042288024862815624473670646072940554294732151308571897295236552684396649767503957047616962978624449348438551386053918285535437988924118937549728089877793860918956</span><br><span class="hljs-comment">(q-1)</span>*<span class="hljs-comment">(r-1)</span> = <span class="hljs-number">154905757014372756191477923232488802075510411348567355414988814359374852064824181741663658727687998705149903985671747780705960374732554616826563203303584163459125118604057521416183781255969121762147826355466246464743348283573511339459135541869974720375624567710723081303090966036696876360406676904859412410388</span><br><span class="hljs-comment">(p-1)</span>*<span class="hljs-comment">(q-1)</span> = <span class="hljs-number">166227463607209004468932873221626620944628889899142110675440222050856617147455380049619547065213045395392929727012833645043930997376712553892400252643682129053352313364478991542722896445389658481349386462407754423678541287560754968000284796665028132977555819700889151726789989252780704135125995666535475823772</span><br><br><span class="hljs-attr"># 输入</span><br><span class="hljs-attr">3</span><br><span class="hljs-number">157843652000901922592922534078798438728561466809160280102796295598657892969643944706331069245997476544245343941352790420588475071314554864105017844042288024862815624473670646072940554294732151308571897295236552684396649767503957047616962978624449348438551386053918285535437988924118937549728089877793860918956</span> <span class="hljs-number">44209639124029393930247375993629669338749966042856653556428540234515804939791650065905841618344611216577807325504984178760405516121845853248373571704473449826683120387747977520655432396578361308033763778324817416507993263234206797363191089863381905902638111246229641698709383653501799974217118168526572365797</span><br><span class="hljs-number">154905757014372756191477923232488802075510411348567355414988814359374852064824181741663658727687998705149903985671747780705960374732554616826563203303584163459125118604057521416183781255969121762147826355466246464743348283573511339459135541869974720375624567710723081303090966036696876360406676904859412410388</span> <span class="hljs-number">116715737414908163105708802733763596338775040866822719131764691930369001776551671725363881836568414327815420649861207859100479999650414099346914809923964116101517432576562641857767638396325944526867458624878906968552835814078216316470330511385701105459053294771612727181278955929391807414985165924450505855941</span><br><span class="hljs-number">166227463607209004468932873221626620944628889899142110675440222050856617147455380049619547065213045395392929727012833645043930997376712553892400252643682129053352313364478991542722896445389658481349386462407754423678541287560754968000284796665028132977555819700889151726789989252780704135125995666535475823772</span> <span class="hljs-number">60735172709413093730902464873458655487237612458970735840670987186877666190533417038325630420791294593669609785154204677845781980482700493870590706892523016041087206844082222225206703139282240453277802870868459288354322845410191061009582969848870045522383447751431300627611762289800656277924903605593069856921</span><br><span class="hljs-attr">#输出</span><br><span class="hljs-attr">SYC&#123;CRT_1</span>s_f<span class="hljs-number">3</span><span class="hljs-symbol">n_but_Gen3</span>hi_i<span class="hljs-name">m9</span>act_is_a_balabalaba&#125;<br></code></pre></td></tr></table></figure><p>得到flag：SYC{CRT_1s_f3n_but_Gen3hi_im9act_is_a_balabalaba}</p><h4 id="小彩蛋"><a href="#小彩蛋" class="headerlink" title="小彩蛋"></a>小彩蛋</h4><p>txt文本：<br>5Lq65Lus5Y+q6K6w5b6X77yM6L+Z5pys5piv6aOO5ZKM5pel5Li955qE5LiA5aSp77yManJsNzc35q2j5Zyo572R5LiK5a2m5Lmg5a+G56CB5a2m44CC5b+954S25LmL6Ze077yM6buR6Imy5raI6YCA77yM5bGP5bmV55m95YWJ6aqk6LW377yM5omA5pyJ55qE6K665paH6YO95reh5Ye655y85biY44CC5LuW5Yed56We5LiA55yL77yM5Y205Y+q5pyJ5rex6YKD5aaC5aKo55qE4oCc5Y6f56We4oCd5LqM5a2X5Zyo5Zue5bqU552A44CC5pyq5Y+K5oCd6ICD77yManJsNzc36ISR6KKL5LiA6Zi15pmV55yp44CC6ICM5q2k5Yi777yM5o+Q55Om54m55aSn6ZmG5LiK56m65pyJ6YeR5YWJ6Zeq54OB77yM56m66Ze05Lmx5rWB5LmL5YaF77yM5LiD56eN5YWD57Sg5Yqb5pKV5byA5LqG5pe256m66KOC57yd77yM6aOO5bim5p2l5LqG5pWF5LqL55qE56eN5a2Q44CC5Y+v5YaN5Z2a5Zu655qE5bKp55+z5Lmf6Zq+6YCD56Oo5o2f55qE5ZG96L+Q44CC4oCc5LiW55WM77yM6YGX5b+Y5oiR44CC4oCd5LuW57uI56m25b+Y6K6w5LqG6Ieq5bexQ3J5cHRvZXLnmoTouqvku73jgILigJzmj5Dnk6bnibnlpKfpmYbnmoTml4XkurrvvIzkvaDog73mib7liLDmiJHpgZflpLHnmoTotKblj7flkJfvvJ/igJ0=<br>base64解码：<br>人们只记得，这本是风和日丽的一天，jrl777正在网上学习密码学。忽然之间，黑色消退，屏幕白光骤起，所有的论文都淡出眼帘。他凝神一看，却只有深邃如墨的“原神”二字在回应着。未及思考，jrl777脑袋一阵晕眩。而此刻，提瓦特大陆上空有金光闪烁，空间乱流之内，七种元素力撕开了时空裂缝，风带来了故事的种子。可再坚固的岩石也难逃磨损的命运。“世界，遗忘我。”他终究忘记了自己Cryptoer的身份。“提瓦特大陆的旅人，你能找到我遗失的账号吗？”</p><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="DEATH-N0TE"><a href="#DEATH-N0TE" class="headerlink" title="DEATH_N0TE"></a>DEATH_N0TE</h2><h4 id="前半段flag"><a href="#前半段flag" class="headerlink" title="前半段flag"></a>前半段flag</h4><p>将图片用steagsolve打开，lsb隐写解码，发现疑似明文：<br>IuS9oOe7p+e7reinguWvn+aJi+S4iua8hum7keiJsueahOeslOiusOacrO+8jOWGt+mdmeS4i+adpeeahOS9oOWPkeeOsOS6huiXj+WcqOWwgemdouacgOS4i+i+ueeahOS4gOihjOWwj+WtlzpTWUN7RDRAVGhfTjB0NF8iCiLkvaDmtY/op4jov4fmlbTkuKrnrJTorrDmnKzvvIzlj6/mg5zlhajmmK/nqbrnmb3pobXvvIzlhbbkuK3mnInkuIDpobXkuI3nn6XpgZPooqvosIHmkpXmjonkuobvvIzkvaDmnIDnu4jov5jmmK/nv7vliLDkuobnvLrlpLHnmoTpgqPkuIDpobUiCiLkvaDnlKjpk4XnrJTmtoLmirnnnYDlkI7pnaLkuIDpobXvvIzkuIrpnaLnvJPnvJPlh7rnjrDkuobpgZflpLHnmoTnl5Xov7kuLi4i<br>base64解码得到：<br>“你继续观察手上漆黑色的笔记本，冷静下来的你发现了藏在封面最下边的一行小字:SYC{D4@Th_N0t4_”<br>“你浏览过整个笔记本，可惜全是空白页，其中有一页不知道被谁撕掉了，你最终还是翻到了缺失的那一页”<br>“你用铅笔涂抹着后面一页，上面缓缓出现了遗失的痕迹…”<br>找到前半截flag：SYC{D4@Th_N0t4_</p><h4 id="后半截flag"><a href="#后半截flag" class="headerlink" title="后半截flag"></a>后半截flag</h4><p>从图片中能隐约看见白色像素点，推测需要提取像素点，构成新图片<br><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs haxe">from PIL <span class="hljs-keyword">import</span> Image  <br>  <br>im = Image.open(<span class="hljs-string">&#x27;d:/Users/ASUS/Downloads/DEATH_N0TE/kamisama.png&#x27;</span>)  <br>pix = im.load()  <br>width = im.size[<span class="hljs-number">0</span>]  <br>height = im.size[<span class="hljs-number">1</span>]  <br><span class="hljs-meta"># 图片查看后猜测间隔距离为5像素  </span><br><span class="hljs-keyword">new</span><span class="hljs-type">_width</span> = width <span class="hljs-comment">// 5  </span><br><span class="hljs-keyword">new</span><span class="hljs-type">_height</span> = height <span class="hljs-comment">// 5  </span><br><br><span class="hljs-keyword">new</span><span class="hljs-type">_img</span> = Image.<span class="hljs-keyword">new</span><span class="hljs-type"></span>(<span class="hljs-string">&quot;RGB&quot;</span>, (<span class="hljs-keyword">new</span><span class="hljs-type">_width</span>, <span class="hljs-keyword">new</span><span class="hljs-type">_height</span>))  <br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>,width,<span class="hljs-number">5</span>):  <span class="hljs-type"></span><br>    <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>,height,<span class="hljs-number">5</span>):  <span class="hljs-type"></span><br>        rgb=pix[x, y]  <br></code></pre></td></tr></table></figure><br>        new_img.putpixel((x//5,y//5),(int(rgb[0]),int(rgb[1]),int(rgb[2])))<br><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><span class="hljs-keyword">new</span><span class="hljs-type">_img</span>.save(<span class="hljs-string">&#x27;new_image.png&#x27;</span>)<br></code></pre></td></tr></table></figure><br>得到图片<br><img src="https://s2.loli.net/2023/12/22/hxV9HM3o6FOlcXi.png" alt=""><br>结合题目，该图片上的花体字是死亡笔记中的一种字体，对照提取得到：TkFNRV9vMnRha3VYWH0=<br>利用base64解码得到后半截flag：NAME_o2takuXX}</p><p>合并得到完整的flag：SYC{D4@Th_N0t4_NAME_o2takuXX}</p><h4 id="小彩蛋-1"><a href="#小彩蛋-1" class="headerlink" title="小彩蛋"></a>小彩蛋</h4><p>IuS9oOaJ vuWIsOS6 huS4gOac rOOAikRF QVRIIE5P VEXjgIvv vIzlpb3l pYflv4Pp qbHkvb/k vaDnv7vl vIDov5nm nKznrJTo rrDvvIzk vaDpmIXo r7vkuobk vb/nlKjo p4TliJnv vIzkvYbm mK/kvaDm g4rorrbl nLDlj5Hn jrDliJrm iY3nmoTo p4TliJnk uYvkuK3l lK/ni6zm sqHmnInn rKwxMOad oS4uLiIK IuS9oOWG jeasoeWO u+ehruiu pOaYr+WQ puWmguat pO+8jOes lOiusOS4 iueahOaW h+Wtl+WN tOS7v+S9 m+a0u+S6 hui1t+ad pe+8jOWc qOS9oOec vOS4reS4 jeaWreWc sOaUvuWk p+e8qeWw j++8jOS9 oOmXreS4 iuS6huWP jOecvC4u LiIKIuWO n+acrOm7 keiJsuea hOaWh+Wt l+S4gOi9 rOWPmOaI kOihgOe6 ouiJsu+8 jOivoeW8 gueahOeU u+mdoui/ mOaYr+WH uueOsOS6 juS9oOea hOinhue9 keiGnOWJ je+8jOS9 oOWGs+Wu muS4jeWG jee6oOe7 k+S6jumB l+Wkseea hOinhOWI me+8jOW5 u+iniea2 iOWkseS6 hi4uLiI=<br>“你找到了一本《DEATH NOTE》，好奇心驱使你翻开这本笔记，你阅读了使用规则，但是你惊讶地发现刚才的规则之中唯独没有第10条…”<br>“你再次去确认是否如此，笔记上的文字却仿佛活了起来，在你眼中不断地放大缩小，你闭上了双眼…”<br>“原本黑色的文字一转变成血红色，诡异的画面还是出现于你的视网膜前，你决定不再纠结于遗失的规则，幻觉消失了…”</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2023/12/18/hello-world/"/>
    <url>/2023/12/18/hello-world/</url>
    
    <content type="html"><![CDATA[<p>This is the first text.</p><p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p><script type="math/tex; mode=display">E=mc^2</script><script type="math/tex; mode=display">\frac{-b-\sqrt{\Delta}}{2a}</script>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
